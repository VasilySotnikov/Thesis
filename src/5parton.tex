In this chapter, we present the central result of the thesis:
the analytic expressions for all two-loop five-parton helicity amplitudes in the leading-color approximation.
%To this date, performing the computation of this level of complexity is
%out of reach of the standard computational techniques discussed in \cref{chap:stdtech}.
To obtain our results, we exploit the full power of the novel multi-loop generalization of the numerical $D$-dimensional unitarity method,
which we discussed in \cref{chap:numunitarity,chap:dshel}.
With these methods, we are able to perform efficient numerical evaluations of the amplitudes in floating-point arithmetics, as well as any number field.
We then obtain the analytic expressions for the amplitudes from numerical evaluations over finite fields,
employing the functional interpolation techniques.

The subject of this chapter have been published in \cite{Abreu:2018jgq,Abreu:2019odu},
and our presentation here is based on those papers.
This chapter is organized as follows.
In \cref{5parton:sec:intro} we give our motivation, and review the state-of-the-art of the related two-loop computations.
In \cref{5parton:sec:amplitudes} we provide a precise definition  of the objects we compute.
In \cref{5parton:sec:tech} we consider some technical details of our implementation, including
the construction of cut equations \eqref{eq:cut_equations}.
We present the high-precision benchmark values for the amplitudes in \cref{sec:5parton:numerics},
and discuss their validation in \cref{sec:Validation-5parton}.
Finally, in \cref{sec:AnalyticForm} we explain how we obtain the analytic expressions from numerical samples,
and analyze their structure.

\section{Introduction}
\label{5parton:sec:intro}

Two-loop amplitudes are ingredients in the NNLO cross-section.
The computation of two-loop amplitudes is much more challenging than one-loop,
Another challenging component is the handling of IR divergences, which we don't discuss.

Are obtain via numerical Monte-Carlo integration. 

The NLO has been success.
We would like to ideally have the same story for NNLO

Our results are an important step towards the automation of
the calculation of two-loop partonic amplitudes, which
are in turn an important ingredient towards obtaining
theory predictions to three-jet production at hadron colliders
at next-to-next-to-leading order (NNLO) in QCD.

Experience at one loop has shown that the direct numerical computation of
scattering amplitudes can avoid difficulties encountered in analytic
approaches. However, while numerical evaluation is sufficient for
phenomenological applications, compact analytic results are still very useful.  
Indeed, the numerical evaluation of analytic expressions is
generally straightforward to set up and oftentimes more stable and efficient
than the purely numerical approach.  Furthermore, explicit formulae allow for a
detailed analysis of the analytic properties of amplitudes in order to learn
about  higher-order perturbation theory.

Recently, significant
progress has been made regarding the computation of two-loop multi-particle
amplitudes.  In the case of five-point QCD amplitudes, the first one to be studied
was the leading-color five-gluon amplitude with all helicities positive, initially
evaluated numerically~\cite{Badger:2013gxa} and  
afterwards presented analytically~\cite{Gehrmann:2015bfy,Dunbar:2016aux}.
Building on this result, the all-plus two-loop six- and seven-gluon amplitudes were
obtained~\cite{Dunbar:2016gjb,Dunbar:2017nfy}.  By now all leading-color
two-loop five-parton amplitudes (i.e., with external gluons and/or
massless quarks) have been computed
numerically~\cite{Badger:2017jhb, Abreu:2017hqn, Badger:2018gip,
Abreu:2018jgq}. 
Very recently, numerical algorithms were combined with
functional reconstruction techniques~\cite{Peraro:2016wsq} resulting in
analytic expressions for the planar two-loop five-gluon single-minus helicity
amplitude~\cite{Badger:2018enw} and for all two-loop five-gluon helicity
amplitudes~\cite{Abreu:2018zmy}. These calculations rely on the availability
of the planar two-loop five-point master
integrals, which have been given in refs.~\cite{Papadopoulos:2015jft,Gehrmann:2018yef}. 
Progress with full-color five-gluon amplitudes~\cite{Badger:2015lda} is 
gaining momentum with recent results towards the computation of non-planar master
integrals~\cite{Abreu:2018aqd,Chicherin:2018old}.
In more conventional approaches, integration-by-parts relations were
obtained~\cite{Boels:2018nrr,Chawdhry:2018awn} which can be, in principle, used to compute the
same type of two-loop five-point amplitudes.

finite-field arithmetic~\cite{vonManteuffel:2014ixa,Peraro:2016wsq} in order to
functionally reconstruct~\cite{Peraro:2019svx,Peraro:2016wsq,Klappert:2019emp} the multivariate rational
coefficients of a basis of special functions~\cite{Gehrmann:2018yef}. We have
already shown that this strategy can be employed to compute amplitudes of
relevance to LHC phenomenology, by providing the analytic expressions of all
planar two-loop five-gluon amplitudes~\cite{Abreu:2018zmy}. In this article we
further improve on the latter work by producing compact analytic results for
all leading-color two-loop five-parton amplitudes in QCD.  

Second, we modify the multivariate reconstruction algorithm that we employed
in ref.~\cite{Abreu:2018zmy} in order to use an ansatz in terms of Mandelstam variables
instead of twistor variables~\cite{Hodges:2009hk}. This is achieved by
exploiting the analytic structure of amplitudes with five external massless
partons in order to obtain target functions which are rational functions of
Mandelstam variables. This has a dramatic impact in reducing the degree of the
multivariate polynomials that we reconstruct, allowing us to obtain all
analytic expressions with a modest computational effort.

Removing the bottleneck of dimensional reconstruction with the methods described in \cref{chap:dshel} 
was the key ingredient to be able to evaluate amplitudes with fermions efficiently.


Finally, in order to employ a single finite field for rational
reconstruction, we perform a systematic analysis of the analytic structure of
the reconstructed functions which takes advantage of two major simplification
procedures. As a by-product, the procedure results in rather compact expressions
for all helicity amplitudes, which we provide as ancillary files. 
We first analyze the dimension of the function
space spanned by all the pentagon-function coefficients on each amplitude. It
turns out that this dimension is an order of magnitude smaller (on average)
than the number of pentagon functions. Then we simplify each member of the
basis of this space with a multivariate partial-fraction decomposition.  All
taken into account, the final expressions we present are reduced in byte size
by up to two orders of magnitude, with final results that can easily be handled
for future analytic and numerical evaluations.

Do not forget \todo{reference Wjj benchmark}

\todo{Also susy stuff and all-plus full color} 

\section{Setup}
\label{5parton:sec:amplitudes}

We consider all
two-loop amplitudes required for the computation of the NNLO QCD corrections to three-jet production at
hadron colliders.
This includes the
five-parton processes with five gluons, two quarks and three gluons, and four
quarks and one gluon,  
\begin{align*}
  &\mathcal{A}^{(2)}(g,g,g,g,g), \\
  &\mathcal{A}^{(2)}(q,\bar{q},g,g,g), \\
  &\mathcal{A}^{(2)}(q,\bar{q},Q,\bar{Q},g),
\end{align*}
and we include the contributions with one or two closed fermion loops.
The representative diagrams are given in \cref{fig_parents5g,fig_parents2q3g,fig_parents4q1g}.
For the $\mathcal{A}^{(2)}(q,\bar{q},Q,\bar{Q},g)$ amplitude, we explicitly provide results for the case 
of different flavours. And the case of identical flavours can be obtain through the anti-symmetrization.

For each process we consider a full set of helicity amplitudes, which we 
define as described in \cref{chap:dshel}.
We take into account charge and parity transformations to reduce
the number of independent helicity amplitudes.

%%%%%%%%%%%%% FIGURE %%%%%%%%%%%%%%%%%%
\begin{figure}[ht]
  \begin{center}
    \begin{tikzpicture}[scale=.9]
    % 5 point masters
    \node at (0,0){\includegraphics[scale=0.5]
    {figures/5g.pdf}};
    % 5 point masters
    \node at (5,0){\includegraphics[scale=0.5]
    {figures/5gnf.pdf}};
    % Level 2 
    \node at (10,0){\includegraphics[scale=0.5]
    {figures/5gnf2.pdf}};
\end{tikzpicture}
\end{center} 
\caption{Representative Feynman diagrams for leading-color
$\CA^{(2)}(g,g,g,g,g)$ amplitudes, contributing at order
$N_f^0$, $N_f^1$ and $N_f^2$.}
\label{fig_parents5g}
\end{figure}

%%%%%%%%%%%%% FIGURE %%%%%%%%%%%%%%%%%%
\begin{figure}[ht]
  \begin{center}
    \begin{tikzpicture}[scale=.9]
    % 5 point masters
    \node at (0,0){\includegraphics[scale=0.5]
    {figures/2q3g.pdf}};
    % 5 point masters
    \node at (5,0){\includegraphics[scale=0.5]
    {figures/2q3gnf.pdf}};
    % Level 2 
    \node at (10,0){\includegraphics[scale=0.5]
    {figures/2q3gnf2.pdf}};
\end{tikzpicture}
\end{center} 
\caption{Representative Feynman diagrams for leading-color
$\CA^{(2)}(q,\bar q,g,g,g)$ amplitudes, 
contributing at order
 $N_f^0$, $N_f^1$ and $N_f^2$.}
\label{fig_parents2q3g}
\end{figure}

%%%%%%%%%%%%% FIGURE %%%%%%%%%%%%%%%%%%
\begin{figure}[ht]
  \begin{center}
    \begin{tikzpicture}[scale=.9]
    % 5 point masters
    \node at (0,0){\includegraphics[scale=0.5]
    {figures/4q1g.pdf}};
    % 5 point masters
    \node at (5,.4){\includegraphics[scale=0.5]
    {figures/4q1gnf.pdf}};
    % Level 2 
    \node at (10,.4){\includegraphics[scale=0.5]
    {figures/4q1gnf2.pdf}};
\end{tikzpicture}
\end{center} 
\caption{Representative Feynman diagrams for leading-color
$\CA^{(2)}(q,\bar q,Q,\bar Q,g)$ amplitudes, 
contributing at order
$N_f^0$, $N_f^1$ and $N_f^2$.}
\label{fig_parents4q1g}
\end{figure}

\subsection{Color Structure}
\label{5parton:sec:color_structures}
We decompose all amplitudes in terms of color structures. 
We denote the fundamental generators of the
$SU(\NC)$-group by $(T^a)^{\;\bar{\jmath}}_{i}$, where the
adjoint index $a$ runs over $\NC^2-1$ values and the 
(anti-) fundamental indices $i$  ($\bar \jmath$)
run over $\NC$ values. The fundamental generators are normalized
as $ \Tr(T^a T^b) = \delta^{ab}$. One can then consider the color decomposition of
each process as
%
\begin{align}
  \begin{split}
    \label{eq:ColorDecG}
    A(1_g, 2_g, 3_g, 4_g, 5_g) \big\vert_{\textrm{leading color}} = &
    \sum_{\sigma\in S_5/Z_5} \Tr\left(
    T^{a_{\sigma(1)}} T^{a_{\sigma(2)}} 
    T^{a_{\sigma(3)}} T^{a_{\sigma(4)}} T^{a_{\sigma(5)}} \right)\\
    &\times \CA({\sigma(1)}_g, {\sigma(2)}_g, {\sigma(3)}_g, {\sigma(4)}_g, {\sigma(5)}_g)\,, 
  \end{split} \\
  \begin{split}
    \label{eq:ColorDec2Q}
    A(1_q, 2_{\bar{q}}, 3_g, 4_g, 5_g) \big\vert_{\textrm{leading color}} 
    = & \sum_{\sigma\in S_3} 
    \left( T^{a_{\sigma(3)}} T^{a_{\sigma(4)}} T^{a_{\sigma(5)}} \right)^{\;\bar{\imath}_2}_{i_1} \\
    & \times\CA(1_q,2_{\bar{q}},\sigma(3)_g,\sigma(4)_g,\sigma(5)_g)\,,
  \end{split}\\
  \begin{split}
    \label{eq:ColorDec4Q}
    A(1_q, 2_{\bar{q}}, 3_Q, 4_{\bar{Q}}, 5_g)
    \big\vert_{\textrm{leading color}} 
    = & 
  %
    \,(T^{a_5})^{\;\bar{\imath}_{2}}_{i_{3}} \delta^{\;\bar{\imath}_{4}}_{i_{1}}\;
  %
    \CA(1_{q}, 2_{\bar{q}}, 5_g, 3_{Q}, 4_{\bar{Q}}) \,\,+  \\
  %
    & \,(T^{a_5})^{\;\bar{\imath}_{4}}_{i_{1}} \delta^{\;\bar{\imath}_{2}}_{i_{3}}\;
  %
    \CA(1_{q},2_{\bar{q}},3_{Q},4_{\bar{Q}},5_g) \,,
  \end{split}
\end{align}
where $S_n$ denotes all permutations of $n$ indices and 
$S_n/Z_n$ all non-cyclic permutations of $n$ indices. 
We write the particle type explicitly as a subscript, and all
remaining properties of each particle (momentum, helicity, 
etc.\@) are implicit. 

The $\CA$ in \cref{eq:ColorDecG,eq:ColorDec2Q,eq:ColorDec4Q} are
called partial amplitudes. For each of the amplitudes considered, all
partial amplitudes can be related to the others by exchanging external
legs, so only one partial amplitude is independent. These are expanded in a perturbative
expansion,
\begin{equation}
    \label{eq:partials} 
    \CA
    = g^{3}_0 \left(
        \CA^{(0)}
      + \frac{\alpha_0}{4\pi}\NC \CA^{(1)}
      + \left(\frac{\alpha_0}{4\pi}\right)^2\NC^2  \CA^{(2)} 
      + \mathcal{O}(\alpha_0^3)
      \right),
\end{equation}
where $\alpha_0=g_0^2/(4\pi)$ is the bare QCD coupling and 
$\CA^{(k)}$ denotes a $k$-loop partial amplitude. Each 
$\CA^{(k)}$ can be further expanded as a series in powers of 
$N_f/N_c$,
\begin{align}
  \label{eq:nfdecomposition} 
  \begin{split}
  \CA^{(1)} &= \CA^{(1)[N_f^0]} + 
  \frac{\NF}{\NC}\CA^{(1)[N_f^1]}\,, \\
  \CA^{(2)} &= \CA^{(2)[N_f^0]} +
  \frac{\NF}{\NC}\CA^{(2)[N_f^1]} +
  \left(\frac{\NF}{\NC}\right)^2\CA^{(2)[N_f^2]}\,.
  \end{split} 
\end{align}
We compute the coefficients $\CA^{(k)[N_f^l]}$, with $0\leq l\leq
k\leq2$, where only planar diagrams contribute as we work in the
leading-color approximation. In figs.~\ref{fig_parents5g},
\ref{fig_parents2q3g} and \ref{fig_parents4q1g} we give representative
diagrams for each of these contributions.


\subsection{Divergence Structure}
\label{sec:IR}

\subsubsection{Renormalization}

We perform renormalization of the QCD coupling in the 
$\overline{\text{MS}}$ scheme. It is implemented by replacing 
the bare coupling by the renormalized one, denoted $\alpha_s$, 
in eq.~\eqref{eq:partials}.
The bare and renormalized couplings are related through
\begin{equation}\label{eq:renormCoupling}
    \alpha_0\mu_0^{2\epsilon}S_{\epsilon}
  =\alpha_s\mu^{2\epsilon}\left(
  1-\frac{\beta_0}{\epsilon}\frac{\alpha_s}{4\pi}
  +\left(\frac{\beta_0^2}{\epsilon^2}-\frac{\beta_1}{\epsilon}\right)
  \left(\frac{\alpha_s}{4\pi}\right)^2+\mathcal{O}
  \left(\alpha_s^3\right)\right),
\end{equation}
where $S_\epsilon=(4\pi)^{\eps}e^{-\eps\gamma_E}$, with
$\gamma_E=-\Gamma'(1)$ the Euler-Mascheroni constant.
$\mu_0^2$ is the scale introduced in dimensional regularization
to keep the coupling dimensionless in the QCD Lagrangian, 
and $\mu^2$ is the renormalization scale. In the following, we
set $\mu_0^2=\mu^2=1$. The leading-color coefficients of the QCD
$\beta$-function are
\begin{equation}
  \beta_0=\frac{\NC}{3} \left( 11 - 2\frac{N_f}{\NC}
  \right),\qquad
  \beta_1=\frac{\NC^2}{3} \left( 17 - \frac{13}{2} \frac{N_f}{\NC} \right).
\end{equation}
The perturbative expansion of the renormalized amplitude is
\begin{equation}\label{eq:renormAmp}
  \mathcal{A}_R = S_\epsilon^{-\frac{\lambda}{2}}
  g_s^\lambda\left(
  \mathcal{A}_R^{(0)}
  +\frac{\alpha_s}{4\pi}\NC\,\mathcal{A}_R^{(1)}
  +\left(\frac{\alpha_s}{4\pi}\right)^2\NC^2\mathcal{A}_R^{(2)}
  +\mathcal{O}(\alpha_s^3)
  \right),
\end{equation}
where $\lambda$ is the power of $g_0$ in the tree amplitude, 
with $\alpha_0=g_0^2/(4\pi)$ and similarly for $\alpha_s$.
For four-parton amplitudes $\lambda=2$, and for five-parton 
amplitudes $\lambda=3$.
The renormalized amplitudes $\mathcal{A}_R^{(i)}$ are related 
to the bare amplitudes $\mathcal{A}^{(i)}$ as follows:
\begin{align}
  \begin{split}
    \label{eq:twoLoopUnRenorm}
    &\mathcal{A}_R^{(0)}=\mathcal{A}^{(0)}, \\
    & \mathcal{A}_R^{(1)}=S_{\epsilon}^{-1}\mathcal{A}^{(1)}
    -\frac{\lambda}{2\epsilon}\frac{\beta_0}{\NC}
    \mathcal{A}^{(0)}\,,\\
    &\mathcal{A}_R^{(2)}=
    S_{\epsilon}^{-2}\mathcal{A}^{(2)}
    -\frac{\lambda+2}{2\epsilon}\frac{\beta_0}{\NC}S_{\epsilon}^
    {-1}
    \mathcal{A}^{(1)}
    +\left(\frac{\lambda(\lambda+2)}{8\epsilon^2}\left(\frac{\beta_0}
    {\NC}\right)^2
    -\frac{\lambda}{2\epsilon}\frac{\beta_1}{\NC^2}\right)
    \mathcal{A}^{
    (0)}\,.
  \end{split}
\end{align}



\subsubsection{Infrared Behavior}

The poles of renormalized amplitudes are of infrared origin and
can be predicted from the previous orders in the perturbative 
expansion 
\cite{Catani:1998bh,Sterman:2002qn,Becher:2009cu,Gardi:2009qi}:
\begin{align}
  \begin{split}\label{eq:catani}
    A_R^{(1)}&=\mathbf{I}^{(1)}_{[n]}(\epsilon)
    A_R^{(0)}+\mathcal{O}
    (\epsilon^0)\,,\\
    A_R^{(2)}&=\mathbf{I}^{(2)}_{[n]}(\epsilon)A_R^{(0)}+\mathbf{I}^{(1)}_{[n]}(\epsilon)
    A_R^{(1)}+\mathcal{O}(\epsilon^0)\,,
  \end{split}
\end{align}
with the operators $\mathbf{I}^{(1)}_{[n]}$ and
$\mathbf{I}^{(2)}_{[n]}$ depending on the number and the type of
the scattering particles. This dependence is denoted by the 
subscript $[n]$.
For amplitudes in the leading-color approximation and for which
all quark lines have distinct flavor, the operators
$\mathbf{I}^{(1)}_{[n]}$ and $\mathbf{I}^{(2)}_{[n]}$ are 
diagonal in color space and can be written in a very compact
form. The operator $\mathbf{I}^{(1)}_{[n]}$ is given by
%
\begin{equation}
  \mathbf{I}^{(1)}_{[n]}(\eps)=-\frac{e^{\gamma_E\eps}}{\Gamma(1-\epsilon)}
  \sum_{i=1}^n\gamma_{a_i,a_{i+1}}
  \left( -s_{i,i+1}\right)^{-\epsilon}\,,
\end{equation}
with the indices defined cyclically.
The index $a_i$ denotes a type of particle with momentum $p_i$, i.e.\  in the context of our paper,
$a_i\in\{g,q,\bar q, Q, \bar Q\}$. We introduced the auxiliary symbols $\gamma_{a,b}$, 
symmetric under the exchange of indices, 
$\gamma_{a,b}=\gamma_{b,a}$, and defined according to:
\begin{align}
  \begin{split}
    \gamma_{g,g}&=\frac{1}{\epsilon^2}+\frac{1}{2\eps}
    \frac{\beta_0}{\NC}\,, \\
    \gamma_{q,Q}&=\gamma_{q,\bar Q}=
    \gamma_{\bar q, Q}=\gamma_{\bar q, \bar Q} 
    =\frac{1}{\epsilon^2}+\frac{3}{2\eps}\,,\\
    \gamma_{g,q}&=\gamma_{g,\bar q}=
    \gamma_{g,Q}=\gamma_{g,\bar Q}=
    \frac{\gamma_{g,g}+\gamma_{q,Q}}{2}\,,\\
    \gamma_{q,\bar q}&=\gamma_{Q,\bar Q}=0\,.
  \end{split}
\end{align}
The operator~$\mathbf{I}^{(2)}_{[n]}$ is
\begin{align}
  \label{eqn:Iop}
  \begin{split} 
    \mathbf{I}^{(2)}_{[n]}(\eps)=&
    -\frac{1}{2}\mathbf{I}^{(1)}_{[n]}(\eps)\mathbf{I}^{(1)}_{[n]}(\eps)
    -\frac{\beta_0}{\NC\epsilon}\mathbf{I}^{(1)}_{[n]}(\eps) + 
    \frac{e^{-\gamma_E\epsilon}\Gamma(1-2\epsilon)}
    {\Gamma(1-\epsilon)}
    \left(\frac{\beta_0}{\NC\epsilon}+K\right)
    \mathbf{I}^{(1)}_{[n]}(2\epsilon) + 
    \mathbf{H}_{[n]}(\epsilon)\,,
  \end{split}
\end{align}
where 
\begin{equation}
K=\frac{67}{9}-\frac{\pi ^2}{3}-\frac{10}{9}\frac{\NF}{\NC}\,,
\end{equation}
and $\mathbf{H}_{[n]}(\epsilon)$ is a diagonal operator at 
leading color that depends on the number of external quarks 
and gluons in the process,
\begin{align}
  \begin{split}
    \mathbf{H}_{[n]}(\epsilon)&=
    \frac{e^{\gamma_E\epsilon}}{\epsilon\Gamma(1-\epsilon)}
    \sum_{i=1}^n\left(
    \delta_{a_i,g}H_g+
    (\delta_{a_i,q}+\delta_{a_i,\bar q}
    +\delta_{a_i,Q}+\delta_{a_i,\bar Q})
    H_q
    \right)\,,
  \end{split}
\end{align}
with (see e.g.\ \cite{Bern:2003ck})
\begin{align}
  \begin{split}
    H_g&= \left(\frac{\zeta_3}{2}+\frac{5}{12}+
    \frac{11\pi^2}{144}\right)
    -\left(\frac{\pi^2}{72}+\frac{89}{108}\right)\frac{N_f}{\NC}
    +\frac{5}{27}\left(\frac{N_f}{\NC}\right)^2\,,\\
    H_q&=
    \left(\frac{7\zeta_3}{4}+\frac{409}{864}
    -\frac{11\pi^2}{96}\right)
    +\left(\frac{\pi^2}{48}-\frac{25}{216}\right)\frac{N_f}{\NC}\,.
  \end{split}
\end{align}

The poles of the bare amplitudes, as presented for example in
tables~\ref{tab:results4parton} and \ref{tab:results5parton}, can be recovered
from those of the renormalized amplitude by using
eqs.~\eqref{eq:twoLoopUnRenorm}.

\subsubsection{Finite Remainder}\label{sec:remainders}

%As we have seen above,
%the bare scattering amplitudes defined in eq.~\eqref{eq:nfdecomposition}
%have divergences of ultraviolet and infrared origin which can be predicted from lower orders in perturbation theory.
%It is convenient to remove this redundant information and define a \emph{finite remainder} that contains the new two-loop information.
%If one is concerned only about removing the divergences a definition of the remainder is not unique, so we now discuss our conventions.

We use the divergent structure of amplitudes, given by  \cref{eq:twoLoopUnRenorm,eq:catani},
to define a finite remainder $\mathcal{F}^{(2)}$ as
\begin{equation}\label{eq:remainderDef}
  \mathcal{F}^{(2)}=\mathcal{A}_R^{(2)}
  -\mathbf{I}_{[n]}^{(1)}\mathcal{A}_R^{(1)}
  -\mathbf{I}_{[n]}^{(2)}\mathcal{A}_R^{(0)}
  +\mathcal{O}(\epsilon)\,.
\end{equation}
Here we expand one-loop amplitudes $\mathcal{A}_R^{(1)}$ to order $\eps^2$ to capture the terms of order $\eps^0$
from the cancellation with the corresponding $\frac{1}{\eps^2}$ pole in the operator $\mathbf{I}_{[n]}^{(1)}$.

%This subtracts non-trivial contributions from
%the finite term of $\mathcal{A}_R^{(2)}$ that are related to 
%the lower-loop amplitudes.
%In section \ref{sec:AnalyticForm} we will obtain analytic expression for the finite remainder directly.
%If necessary one can then recover the two-loop bare amplitude $\CA^{(2)}$ by inverting
%the relations \eqref{eq:twoLoopUnRenorm}:
%\begin{align}
  %\begin{split}
    %\label{eq:ampFromRem}
    %{\mathcal{A}}^{(2)}=&\,\mathcal{F}^{(2)}+
    %S_\epsilon{\mathcal{A}}^{(1)}
    %\left(\mathbf{I}_{[n]}^{(1)}+\frac{5}{2\epsilon}
    %\frac{\beta_0}
    %{N_c}\right)\\
    %&-S_\epsilon^2 {\mathcal{A}}^{(0)}
    %\left(
    %\frac{15}{8\epsilon^2}
    %\left(\frac{\beta_0}{N_c}\right)^2+\frac{3}{2\epsilon}
    %\left(\frac{\beta_0}{N_c}\mathbf{I}_{[n]}^{(1)}-
    %\frac{\beta_1}{N_c^2}\right)-\mathbf{I}_{[n]}^{(2)}
    %\right)+\mathcal{O}(\epsilon)\,.
  %\end{split}
%\end{align}

\subsection{Construction of Cut Equations}
\label{5parton:sec:tech}

\subsubsection{Master/Surface Integrand Parametrization}

Let us first describe how do we obtain the master/surface integrand parametrization (see \cref{sec:ansatz_integrand} for details)
in the right-hand  side of \cref{eq:cut_equations} for all of the topologies appearing in five-parton amplitudes (see \cref{fig:PropagatorStructures}).
We employ the implementation of computational algebraic geometry methods in the package \textsc{Singular} \cite{DGPS}
to solve the non-doubling conditions \eqref{eq:non_doubling_ibp_vectors},
and find the corresponding unitarity-compatible IBP vectors.
Some technical details of our setup can be found in \cite{Abreu:2017hqn}.
We then use these vectors to generated an overcomplete set of surface terms by multiplying
them with all monomials in ISPs, and inserting them into \cref{eq:ibps}.
Finally, we identify the spanning set with imposed on-shell conditions, on a randomly chosen numerical 
point.


The fast evaluation of surface terms is crucial in our approach.
To this end, we employ the following optimizations:
\begin{itemize}
  \item We represent the analytic expressions for the surface terms
    as the linear combinations of components of IBP-generating vectors, multiplied by derivatives of the ISPs,
    plus the divergences of the IBP-vectors (multiplied by ISPs). 
    Effectively, this implements the caching of common sub-expressions, which would be found in the full expression for the corresponding surface term.
  \item We optimize the expressions with the help of the command \texttt{\#optimize} from \texttt{FORM} \cite{Vermaseren:2000nd},
    which implements an extensive set of methods to bring the polynomials into the most efficient computational form.
\end{itemize}

%%%%%%%%%%%%% FIGURE %%%%%%%%%%%%%%%%%%
\begin{figure}[ht] 
  \begin{center}
    \begin{tikzpicture}[scale=1.1]
    % 5 point masters
      \node at (2.5,0){\includegraphics[scale=0.4]{figures/topologies/BoxPentagon}};
      \node at (5,0){\includegraphics[scale=0.4]{figures/topologies/TriangleHexagonRed1}};
      \node at (7.5,0){\includegraphics[scale=0.4]{figures/topologies/BubbleHeptagon}};
    % Level 2 
      \node at
      (0,-1.9){\includegraphics[scale=0.4]{figures/topologies/BoxBoxSG}};
      \node at
      (2.5,-2.0){\includegraphics[scale=0.4]{figures/topologies/BoxBox}};
      \node at
      (5,-2.0){\includegraphics[scale=0.35]{figures/topologies/BubbleHexagonRed1}};
      \node at
      (7.5,-2.0){\includegraphics[scale=0.35]{figures/topologies/BubbleHexagonRed2}};
      \node at
      (10,-2.0){\includegraphics[scale=0.35]{figures/topologies/BubbleHexagonRed3}};
    %
      \node at
      (0,-3.6){\includegraphics[scale=0.35]{figures/topologies/TrianglePentagonRed1}};
      \node at
      (2.5,-3.6){\includegraphics[scale=0.35]{figures/topologies/TrianglePentagonRed2}};
      \node at
      (5,-3.6){\includegraphics[scale=0.35]{figures/topologies/TrianglePentagonRed3}};
      \node at
      (7.5,-3.6){\includegraphics[scale=0.35]{figures/topologies/TrianglePentagonRed4}};
      \node at
      (10,-3.6){\includegraphics[scale=0.4]{figures/topologies/BoxTriangle1LS}};
    % Level 3
      \node at
      (0,-5.5){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonG}};
      \node at
      (2,-5.5){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed1}};
      \node at
      (4,-5.5){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed2}};
      \node at
      (6,-5.5){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed3}};
      \node at
      (8,-5.5){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed4}};
      \node at
      (10,-5.5){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed5}};
    %
      \node at
      (0,-7){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed6}};
      \node at
      (2,-7){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed7}};
      \node at
      (4,-7){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonRed8}};
      \node at
      (6,-7){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleG}};
      \node at
      (8,-6.9){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleSG}};
      \node at
      (10,-6.9){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleRed1}};
    %
      \node at
      (0,-8.4){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleRed2}};
      \node at
      (2,-8.4){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleRed3}};
      \node at
      (4,-8.5){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleRed4}};
      \node at
      (6,-8.5){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleRed5}};
      \node at
      (8,-8.5){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleRed6}};
      \node at
      (10,-8.5){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleRed7}};
    %
      \node at
      (3,-9.8){\includegraphics[scale=0.4]{figures/topologies/BoxBubble1LS}};
      \node at
      (5,-9.8){\includegraphics[scale=0.35]{figures/topologies/TriangleTriangle1LS}};
      \node at
      (7,-9.8){\includegraphics[scale=0.35]{figures/topologies/TriangleTriangle1LSG}};
    % Level 4
      \node at
      (0,-11.5){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleGBox}};
      \node at
      (2,-11.5){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleGBub}};
      \node at
      (4,-11.5){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleRed1}};
      \node at
      (6,-11.5){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleRed2}};
      \node at
      (8,-11.5){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleRed3}};
      \node at
      (10,-11.5){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleRed4}};
    %
      \node at
      (0,-12.7){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleRed5}};
      \node at
      (2,-12.7){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleRed6}};
      \node at
      (4,-12.7){\includegraphics[scale=0.45]{figures/topologies/TriangleTriangleGDiag}};
      \node at
      (6,-12.7){\includegraphics[scale=0.45]{figures/topologies/TriangleTriangleGOffDiag}};
      \node at
      (8,-12.6){\includegraphics[scale=0.45]{figures/topologies/TriangleTriangleSG}};
      \node at
      (10.2,-12.75){\includegraphics[scale=0.45] {figures/topologies/TriangleTriangleRed1}};
    %
      \node at
      (0,-13.8){\includegraphics[scale=0.45]{figures/topologies/TriangleTriangleRed2}};
      \node at
      (2.15,-13.8){\includegraphics[scale=0.45] {figures/topologies/TriangleTriangleRed3}};
      \node at
      (4.3,-13.8){\includegraphics[scale=0.45] {figures/topologies/TriangleTriangleRed4}};
      \node at
      (6.45,-13.95){\includegraphics[scale=0.4] {figures/topologies/BubbleTriangle1LS}};
      \node at
      (8.6,-13.95){\includegraphics[scale=0.4] {figures/topologies/BubbleTriangle1LS_2}};
      \node at
      (10.75,-13.95){\includegraphics[scale=0.4] {figures/topologies/BubbleTriangle1LSG}};
    % Level 6
      \node at
      (0,-15.5){\includegraphics[scale=0.5]{figures/topologies/BubbleTriangleG1Mass}};
      \node at
      (1.8,-15.5){\includegraphics[scale=0.5]{figures/topologies/BubbleTriangleG2Mass}};
      \node at
      (3.6,-15.5){\includegraphics[scale=0.5]{figures/topologies/BubbleTriangleSG}};
      \node at
      (5.4,-15.5){\includegraphics[scale=0.5]{figures/topologies/BubbleTriangleRed1}};
      \node at
      (7.2,-15.5){\includegraphics[scale=0.5]{figures/topologies/BubbleTriangleRed2}};
      \node at
      (9,-15.55){\includegraphics[scale=0.5]{figures/topologies/BubbleBubble1LS}};
      \node at
      (10.8,-15.5){\includegraphics[scale=0.5]{figures/topologies/BubbleBubble1LS_2}};
     % Level 7
      \node at
      (5.25,-17){\includegraphics[scale=0.6]{figures/topologies/Sunrise}};
    \end{tikzpicture}
  \end{center}
  \caption{A complete set of topologies appearing in two-loop five-parton scattering, arranged
    in the order of decreasing number of propagators.
    All lines are massless, with massive external legs being denoted by two massless external lines entering a vertex.
    The figure is taken from \cite{Abreu:2017hqn}.
  }
  \label{fig:PropagatorStructures}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Hierarchies and Color Decomposition}

We now describe how do we organize the amplitudes into a set of cut equations \cref{eq:cut_equations} for master/surface coefficients.

First we generate all cut diagrams contributing to the amplitude with \textsc{QGRAF} \cite{Nogueira:1991ex}.
To obtain the \emph{cut diagrams}, instead of Feynman diagrams,
we list all possible tree amplitudes as allowed vertices in the model files,
and request the one-particle-irreducible diagrams only.

We then process these diagrams with a custom  \texttt{Mathematica} code, which performs three steps:
\begin{enumerate}
  \item Organize the cut diagrams into the hierarchy (see \cref{eq:topology_order,eq:topology_sequence}) 
    This amounts to constructing a layered tree graph with vertices as nodes,
    and the relation of adding/removing propagators as edges.
  \item Color decomposition into partial amplitudes.
  \item Decomposition of each cut diagram into polynomials in $(D_s-6)$, as described in \cref{dshel:sec:unitarity-compatible}.
\end{enumerate}
In principle, the order of these steps is irrelevant.
The purpose of color decomposition is to separate the color factors from the rest of the computation, 
such that  the partial amplitudes (see \cref{5parton:sec:color_structures}) are evaluated in terms of color-stripped Feynman rules of \cref{sec:cofr}.
Our color decomposition is based on \cite{Ochirov:2016ewn,Ochirov:2019mtf},
and is accomplished in the same ``unitarity-compatible'' spirit of the algorithm discussed in \cref{dshel:sec:unitarity-compatible}.
We process each cut diagram separately in the following way:
\begin{enumerate}
  \item Decompose each of it's vertices (i.e.\ tree amplitudes) into linear combinations of color-ordered tree amplitudes multiplied by color factors.
  \item Insert the decompositions from the previous step into the diagram and expand.
  \item Contract all internal color indices through the cut propagators, and perform the color algebra
  \item Collect the terms with the same color factor, $N_c$, and $N_ f$ powers. 
\end{enumerate}
In this way, we find all terms contributing to the partial amplitudes,
and, by construction, the tree amplitudes in the corners of all cut diagrams are color-ordered tree amplitudes.


\subsubsection{Color-Stripped Cuts}
The products of tree amplitudes in cut diagrams contributing to the partial amplitudes are evaluated
numerically with the custom \texttt{C++} implementation of the off-shell recursion, as described in \cref{sec:evaluation_of_cuts}.
We have implemented evaluations both in multi-precision floating-point arithmetic, and over finite fields with cardinalities of the order $2^{31}$.
For the former we use the QD \cite{QD} library. And for the latter we use \texttt{Givaro} \cite{Givaro} with 
custom optimizations of multiplications through Barrett reduction \cite{Barrett1987a,Hoeven2014}.
The finite-filed evaluations are crucial for the reconstruction of the analytic expressions.

In the off-shell recursion we use explicit components of six-dimensional loop momenta 
satisfying the cut conditions (see \cref{sec:osm} for details). 
This has an important implication for the evaluations over finite fields, where
we cannot take square roots originating from the quadratic equations.
We workaround this complication by allowing the off-shell currents to
take values in an algebraic extension of the finite field.
We consider this in more detail in \cref{sec:muij_square_roots}.
However, since the cuts of properly defined (normalized) helicity amplitudes are Lorentz scalars,
we can still solve the cut equations \eqref{eq:cut_equations} in non-extended finite fields.
For the same reason, the signature of the metric tensor is non-essential, as long as values 
of the invariants do not change. This allows us to employ the alternating metric signature $\{+,-,+,-,\ldots{}\}$
and avoid the usage of complex numbers whatsoever, which represents a significant optimization.

We solve the linear systems of equations for the coefficients with a custom implementation of PLU factorization and back substitution
when working with finite fields. In floating-point arithmetic we solve the equations with the QR factorization,
as implemented in \texttt{Eigen} \cite{eigen}.




\section{Numerical Results}
\label{sec:5parton:numerics}

In this section, we provide the numerical benchmark values for a full set of  five-parton two-loop helicity amplitudes.
For completeness we also provide the values  of the corresponding one-loop amplitudes to $\order{\eps^2}$.
We also provide the values of the four-parton two-loop amplitudes, which we used for the validation.

The partial two-loop helicity amplitudes are represented in terms of master integrals $I_{\Gamma,i}$ (see \cref{fig:MasterInt}) as
\begin{equation} \label{eq:ampl_master_integrals}
  \mathcal{A}^{(2)}=\sum_{\Gamma\in\Delta}
  \sum_{i\in M_\Gamma} c_{\Gamma,i}\,
  \mathcal{I}_{\Gamma,i}\,,
  \quad
    \qquad I_{\Gamma,i} =
      \qty(\int \prod_{i=1}^{L} \tilde{\dd{\ell_i}}) \frac{m_{\Gamma,i}}{\prod_{j\in P_\Gamma} \rho_j^{\gamma_{\Gamma i,j}}},
\end{equation}
and we obtain the master coefficients as explained in great detail above.
The master integrals are computed as a Laurent series in $\eps$, 
%The master integrals for planar five-parton amplitudes has been computed in \cite{Papadopoulos:2015jft,Gehrmann:2018yef}.
with the coefficient of each power evaluated to linear combinations of multiple polylogarithms (MPLs). 
We now also expand the master-integral coefficients (which are rational functions of $D=4-2\eps$) in a Laurent series in $\eps$.
To obtain the numerical values of the amplitudes we employ two different choices of master integrals.
In both cases we will limit ourselves to the \emph{Euclidian} region, which for the case of five-parton
amplitudes corresponds to all invariants being negative. In \cite{Gehrmann:2018yef} the analytic
continuation to all physical regions has been carried out, so it is rather straightforward to extend
our results to these regions.\footnote{
  Note that our method of obtaining master-integral coefficients is indifferent to the choice of the region.
}

\begin{figure}[ht] 
  \begin{center}
    \begin{tikzpicture}[scale=1.2]
    % 5 point masters
      \node at (5,0){\includegraphics[scale=0.4]{figures/topologies/BoxPentagon}};
      \node at (5,-1){3 masters};
    % Level 2 
      \node at
      (2.5,-1.5){\includegraphics[scale=0.4]{figures/topologies/BoxBoxSG}};
      \node at (2.5,-2.3){3 masters};
      \node at
      (7.5,-1.6){\includegraphics[scale=0.4]{figures/topologies/BoxBox}};
      \node at (7.5,-2.3){2 masters};
    % Level 3
      \node at
      (0.5,-3.3){\includegraphics[scale=0.35]{figures/topologies/BubblePentagonG}};
      \node at (0.5,-4.1){2 masters};
      \node at
      (3.5,-3.3){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleG}};
      \node at (3.5,-4.1){2 masters};
      \node at
      (6.5,-3.2){\includegraphics[scale=0.4]{figures/topologies/BoxTriangleSG}};
      \node at (6.5,-4.1){1 master};
      \node at
      (9.5,-3.3){\includegraphics[scale=0.4]{figures/topologies/BoxBubble1LS}};
      \node at (9.5,-4.1){1 master};
    % Level 4
      \node at
      (0,-4.9){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleGBox}};
      \node at (0,-5.7){1 master};
      \node at
      (2.5,-4.9){\includegraphics[scale=0.45]{figures/topologies/BoxBubbleGBub}};
      \node at (2.5,-5.7){1 master};
      \node at
      (5,-4.9){\includegraphics[scale=0.45]{figures/topologies/TriangleTriangleGDiag}};
      \node at (5,-5.7){1 master};
      \node at
      (7.5,-4.9){\includegraphics[scale=0.45]{figures/topologies/TriangleTriangleGOffDiag}};
      \node at (7.5,-5.7){2 masters};
      \node at
      (10,-4.8){\includegraphics[scale=0.45]{figures/topologies/TriangleTriangleSG}};
      \node at (10,-5.6){1 master};
    % Level 6
      \node at
      (0.5,-6.5){\includegraphics[scale=0.5]{figures/topologies/BubbleTriangleG1Mass}};
      \node at (0.5,-7.3){1 master};
      \node at
      (3.5,-6.5){\includegraphics[scale=0.5]{figures/topologies/BubbleTriangleG2Mass}};
      \node at (3.5,-7.3){1 master};
      \node at
      (6.5,-6.5){\includegraphics[scale=0.5]{figures/topologies/BubbleBubble1LS}};
      \node at (6.5,-7.3){1 master};
      \node at
      (9.5,-6.45){\includegraphics[scale=0.5]{figures/topologies/BubbleBubble1LS_2}};
      \node at (9.5,-7.2){1 master};
     % Level 7
      \node at
      (5,-8.2){\includegraphics[scale=0.6]{figures/topologies/Sunrise}};
      \node at (5,-9){1 master};
    \end{tikzpicture}
  \end{center}
  \caption{Topologies with master integrals.
    The figure is taken from \cite{Abreu:2017hqn}.
  }
  \label{fig:MasterInt}
\end{figure}


\paragraph{PTW basis.}
For the five-point master integrals we make use of the publicly available implementation distributed with the paper \cite{Papadopoulos:2015jft}.
For lower point integrals, we implemented the analytic expressions provided in \cite{Gehrmann:2000zt}.
In the case of factorizable topologies we choose the
scalar integral as a master and calculate them independently. In order
to evaluate the necessary multiple polylogarithms we use the
implementation in \texttt{GiNaC}~\cite{Vollinga:2004sn}, which can be
tuned to the desired precision.

\paragraph{Pentagon functions.}
The MPLs are a class of special functions with 
only logarithmic singularities that can be equipped with algebraic
structures that allow one to algorithmically find relations between
them~\cite{Goncharov:2010jf,Duhr:2011zq,Duhr:2012fh}. One can then
construct a basis for the space of MPLs relevant for five-parton
scattering amplitudes, and this was achieved in~\cite{Gehrmann:2018yef}
where the so-called pentagon functions were introduced.
Further, MPLs are equipped with a notion of weight, which can
be used to organize the pentagon functions. Indeed, there are
no relations between pentagon functions of different weight so we can
separate the space of pentagon functions into subspaces of different 
weights. 
The motivation for this decomposition is
that order by order in $\eps$ the master integrals satisfy more
IBP identities. These additional relations are manifested by the pentagon
function decomposition.

For two-loop amplitudes, we need the pentagon functions of at most weight 4.
After expansion in epsilon, the amplitude can, thus, be written as
\begin{equation} \label{eq:pentagon_function_decomposition}
  \mathcal{A}^{(2)}=
    \sum_{i\in B}\sum_{k=-4}^0\epsilon^{k}
    d_{k,i}(\vb*{x})~h_i\,,
\end{equation}
where we use the fact that the poles in $\epsilon$ of two-loop amplitudes are at most $\mathcal{O}(\epsilon^{-4})$.
Here we denote the pentagon functions by $\{h_i\}_{i\in B}$, and the associated set of labels $B$. 
For convenience we use the convention that the set of pentagon functions $\{h_i\}_{i\in B}$
not only includes genuine functions, such as $\log(-s_{12})$, but also
constants with weight, such as $\pi^2$, that correspond to the pentagon 
functions evaluated at specific points. These are boundary conditions that
are specific to the kinematic region where the amplitude is evaluated.

We carried out an independent computation of all master integrals in terms of the pentagon functions, and
we have implemented their semi-analytic representation in our \texttt{C++} framework. This is required  in order to 
transform the amplitude from the form of \cref{eq:ampl_master_integrals} to the form of \cref{eq:pentagon_function_decomposition}.
We obtain the numerical values of the pentagon functions from the \texttt{C++} library distributed with the ref.\ \cite{Gehrmann:2018yef}.

All presented benchmark values for helicity amplitudes are computed with the renormalization scale $\mu=1$,
and are normalized to be dimensionless.
We provide explicitly the components of external momenta, for which the benchmark values are obtained.
We note, however, that this information is redundant, and arbitrary Lorentz boosts
can be performed.
In order to expose the pole structure of the two-loop amplitudes (see \cref{sec:IR}) we normalize them to
the corresponding tree-level amplitude if
it is non-vanishing, or to the corresponding $\CA^{(1)[N_f^0]}(\epsilon=0)$ amplitude otherwise.
The constant factors are fixed by the expansion in \cref{eq:partials,eq:nfdecomposition}

\subsection{Four-Parton Amplitudes}

We evaluate the four-gluon, two-quark two-gluon and four-quark
amplitudes at the phase-space point%
\footnote{Units of energy are chosen arbitrarily.
  The amplitudes presented in the tables \cref{tab:results4parton,tab:results4parton1L}
  are normalized to be dimensionless.
}
%
\begin{equation}
  s_{12}=-\frac{3}{4}, \; s_{23}=-\frac{1}{4},
  \quad
  \begin{aligned}[c]
    p_1 &= \vphantom{\frac{1}{48}}\left(1,1,-i,1\right), \\
    p_2 &= -\frac{1}{16}\left(3,0,0,-3\right), \\
  \end{aligned}
  \quad
  \begin{aligned}[c]
    p_3 &= \frac{1}{48}\left(25,-51,45\,i,7\right),\\
    p_4 &= -\frac{1}{48}\left(64,-3,-3\,i, 64\right), \\
  \end{aligned}
  \label{eq:EvalPoint4}
\end{equation}
where $s_{ij}=(p_i+p_j)^2$. The components are given in the standard signature $\{+,-,-,\ldots{}\}$.
The third component is complexified, such that the corresponding value in the alternating signature $\{+,-,+,-,\ldots{}\}$ 
is explicit.

In \cref{tab:results4parton1L,tab:results4parton} we show numerical results for
the bare one-loop and two-loop four-parton helicity amplitudes.
The results have been obtained with exact values for the 
integral coefficients\footnote{
  The exact rational values are obtained via finite-field evaluations and rational reconstruction (see \cref{sec:ff_fp}).
} 
and with the master integrals 
evaluated to a precision that allows to show 10
significant digits.

\begin{table}[h]
  \centering
  \begin{adjustbox}{width=1\textwidth}
    \begin{tabular}{cccccc}
      \toprule
      $\CA^{(1)[N_f^0]}/\CA^\mathrm{(norm)}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   &   $\epsilon^{1}$  &  $\epsilon^{2}$ \\
      \midrule
      $(1_g^+,2_g^+,3_g^+,4_g^+)$ & $0$ & $0$ & $1$ & 
      $3.144383516$
      & $4.993655130$ \\
      $(1_g^-,2_g^+,3_g^+,4_g^+)$ & $0$ & $0$ & $1$ & 
      $6.037021519$
      & $19.41121185$ \\
      $(1_g^-,2_g^-,3_g^+,4_g^+)$ &  $-4.000000000$ &
      $-14.82985386$ &
      $-21.50563510$ & $-4.242972632$ & $39.45669987$ \\
      $(1_g^-,2_g^+,3_g^-,4_g^+)$ &  $-4.000000000$ &
      $-14.82985386$ & $-24.34737636$ & $-23.80446527$ &
      $-30.91926414$\\ \midrule
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^+)$ & $0$ & $0$ & $1$ &
      $5.886473216$  & $18.18093693$   \\
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^-)$ & $-3.000000000$ &
      $-10.42169654$ & $-13.75537910$ & $-2.227311547$ &
      $15.67564907$ \\
      $(1_q^+,2_{\bar q}^-,3_g^-,4_g^+)$ & $-3.000000000$ &
      $-10.42169654$ &
      $-10.64041688$ & $20.52306512$ & $101.8467214$ \\
      \midrule
      $(1_q^+,2_{\bar q}^-,3_Q^-,4_{\bar Q}^+)$ & $-2.000000000$ &
      $-6.013539220$  & $4.503971305$ & $55.27734017$ &
      $156.3375209$ \\
      $(1_q^+,2_{\bar q}^-,3_Q^+,4_{\bar Q}^-)$ & $-2.000000000$ &
      $-6.013539220$  & $-1.512122300$ & $22.96961380$ &
      $57.55706218$ \\
      \toprule
      $\CA^{(1)[N_f^1]}/\CA^\mathrm{(norm)}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   &   $\epsilon^{1}$  &  $\epsilon^{2}$ \\
      \midrule
      $(1_g^+,2_g^+,3_g^+,4_g^+)$ & $0$ & $0$ & $-1.000000000$ &
      $-4.144383516$ & $-9.138038646$\\
      $(1_g^-,2_g^+,3_g^+,4_g^+)$ & $0$ & $0$ & $-1.000000000$ &
      $-7.037021519$ & $-26.44823337$ \\
      $(1_g^-,2_g^-,3_g^+,4_g^+)$ & $0$ & $0.6666666667$ &
      $3.337846407$ & $7.778113386$ & $9.642499788$ \\
      $(1_g^-,2_g^+,3_g^-,4_g^+)$ & $0$ & $0.6666666667$ &
      $3.888266255$ & $11.57993010$ & $23.40355137$ \\
      \midrule
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^+)$ & $0$ & $0$ &
      $-0.1818181818$ & $-1.074210422$ & $-3.518712119$ \\
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^-)$ & $0$ & $0$ & $0$ & $0$ & $0$ \\
      $(1_q^+,2_{\bar q}^-,3_g^-,4_g^+)$ & $0$ & $0$ & $0$ & $0$ & $0$ \\
      \midrule
      $(1_q^+,2_{\bar q}^-,3_Q^-,4_{\bar Q}^+)$ & $0$ &
      $-0.6666666667$ & $-2.605438214$ & $-5.691068008$ &
      $-8.728233619$ \\
      $(1_q^+,2_{\bar q}^-,3_Q^+,4_{\bar Q}^-)$ & $0$ &
      $-0.6666666667$ & $-2.605438214$ & $-5.691068008$ &
      $-8.728233619$ \\
      \bottomrule
    \end{tabular}
  \end{adjustbox}
\caption{The bare one-loop four-parton helicity amplitudes 
  evaluated at the phase space point in \cref{eq:EvalPoint4}. We set the
    normalization factor $\CA^\mathrm{(norm)}$ to $\CA^{(1)[N_f^0]}(\epsilon=0)$ for the
    amplitudes with vanishing trees, and to $\CA^{(0)}$ otherwise.}
  \label{tab:results4parton1L}
\end{table}

\begin{table}[h]
  \begin{adjustbox}{width=1\textwidth}
    \centering
    \begin{tabular}{cccccc}
      \toprule
      $\CA^{(2)[N_f^0]}/\CA^\mathrm{(norm)}$	  &   $\epsilon^{-4}$   &   $\epsilon^{-3}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   \\
      \midrule
      $( 1_g^+, 2_g^+, 3_g^+, 4_g^+ )$ & 0 & 0 & $-4.000000000$ & $-23.74072126$ & $-63.52221777$ \\
      $( 1_g^-, 2_g^+, 3_g^+, 4_g^+ )$ & 0 & 0 & $-4.000000000$ & $-35.31127327$ & $-133.5083818$ \\
      $( 1_g^-, 2_g^-, 3_g^+, 4_g^+ )$ & $8.000000000$ & $55.65274878$ & $164.6421815$ & $222.3267401$ & $-8.390444844$ \\
      $( 1_g^-, 2_g^+, 3_g^-, 4_g^+ )$ & $8.000000000$ & $55.65274878$ & $176.0091465$ & $332.2956004$ & $486.5023259$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+ )$ & 0 & 0 & $-3.000000000$ & $-24.41444952$ & $-74.97642231$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^- )$ & $4.500000000$ & $28.51508962$ & $73.34964082$ & $75.65107559$ & $-9.311163231$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^-, 4_g^+ )$ & $4.500000000$ & $28.51508962$ & $64.00475414$ & $-13.64171730$ & $-376.4555455$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^- )$ & $2.000000000$ & $10.19374511$ & $8.003461515$ & $-55.57160018$ & $-92.52942183$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+ )$ & $2.000000000$ & $10.19374511$ & $-4.028725695$ & $-134.3060579$ & $-234.1564069$ \\
      \toprule
      $\CA^{(2)[N_f^1]}/\CA^\mathrm{(norm)}$	  &   $\epsilon^{-4}$   &   $\epsilon^{-3}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   \\
      \midrule
      $( 1_g^+, 2_g^+, 3_g^+, 4_g^+ )$ & 0 & 0 & $4.000000000$ & $27.74072126$ & $86.81849458$ \\
      $( 1_g^-, 2_g^+, 3_g^+, 4_g^+ )$ & 0 & 0 & $4.000000000$ & $39.31127327$ & $172.4199379$ \\
      $( 1_g^-, 2_g^-, 3_g^+, 4_g^+ )$ & 0 & $-2.000000000$ & $-15.96133691$ & $-59.69423578$ & $-141.8161833$ \\
      $( 1_g^-, 2_g^+, 3_g^-, 4_g^+ )$ & 0 & $-2.000000000$ & $-18.16301631$ & $-81.04594245$ & $-230.6319267$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+ )$ & 0 & 0 & $0.5454545455$ & $3.784151849$ & $3.326492162$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^- )$ & 0 & $0.5000000000$ & $4.307232180$ & $15.70646205$ & $21.70488360$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^-, 4_g^+ )$ & 0 & $0.5000000000$ & $4.307232180$ & $13.62982056$ & $-12.51632628$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^- )$ & 0 & $1.666666667$ & $10.55774898$ & $23.90612711$ & $-30.33285238$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+ )$ & 0 & $1.666666667$ & $10.55774898$ & $15.88466897$ & $-106.4874291$ \\
      \toprule
      $\CA^{(2)[N_f^2]}/\CA^\mathrm{(norm)}$	  &   $\epsilon^{-4}$   &   $\epsilon^{-3}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   \\
      \midrule
      $( 1_g^+, 2_g^+, 3_g^+, 4_g^+ )$ & 0 & 0 & 0 & 0 & $1.444444444$ \\
      $( 1_g^-, 2_g^+, 3_g^+, 4_g^+ )$ & 0 & 0 & 0 & 0 & $0$ \\
      $( 1_g^-, 2_g^-, 3_g^+, 4_g^+ )$ & 0 & 0 & 0 & 0 & $0.03086419753$ \\
      $( 1_g^-, 2_g^+, 3_g^-, 4_g^+ )$ & 0 & 0 & 0 & 0 & $0$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+ )$ & 0 & 0 & 0 & $0.1212121212$ & $1.189856320$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^- )$ & 0 & 0 & 0 & 0 & $0$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^-, 4_g^+ )$ & 0 & 0 & 0 & 0 & $0$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^- )$ & 0 & 0 & $0.4444444444$ & $3.473917619$ & $14.37639897$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+ )$ & 0 & 0 & $0.4444444444$ & $3.473917619$ & $14.37639897$ \\
      \bottomrule
    \end{tabular}
  \end{adjustbox}
  \caption{The bare two-loop four-parton helicity amplitudes evaluated
    at the phase space point in \cref{eq:EvalPoint4}. We set the
    normalization factor $\CA^\mathrm{(norm)}$ to $\CA^{(1)[N_f^0]}(\epsilon=0)$ for the
    amplitudes with vanishing trees, and to $\CA^{(0)}$ otherwise.} 
  \label{tab:results4parton}
\end{table}


\subsection{Five-Parton Amplitudes}
\label{sec:fivepartonRes}
We evaluate the five-parton amplitudes at the phase-space point%
\footnote{Units of energy are chosen arbitrarily.
  The amplitudes presented in \cref{tab:results5parton,tab:results5parton1L}
  are normalized to be dimensionless.
}
\begin{equation}
  \begin{aligned}[c]
    p_1 &= \left( \frac{1}{2}, \frac{45}{272}, \frac{45 i}{272}, \frac{1}{2} \right), \\
    p_2 &= \left( -\frac{1}{2}, 0, 0, \frac{1}{2} \right), \\
    p_3 &= \left( \frac{21}{26}, -\frac{21}{26}, -\frac{5 i}{26}, -\frac{5}{26} \right),
  \end{aligned}
  \qquad
  \begin{aligned}[c]
    p_4 &= \left( -\frac{1169}{2652}, \frac{2165}{10608}, -\frac{13459 i}{38896}, -\frac{5075}{9724} \right),\\[3ex]
    p_5 &= \left( -\frac{973}{2652}, \frac{581}{1326}, \frac{1813 i}{4862}, -\frac{2779}{9724} \right),
  \end{aligned}
  \label{eq:EvalPoint5}
\end{equation}
with corresponding invariants $s_{ij}=(p_i+p_j)^2$,
\begin{align}
  \label{eq:Invs5pt}
  \begin{split}
    s_{12} =& -1, \quad s_{23} = -8/13, \quad s_{34} = -1094/2431,\\
    &s_{45} = -7/17, \quad s_{51} = -749/7293\ .
  \end{split}
\end{align}
The components are given in the standard signature $\{+,-,-,\ldots{}\}$.
The third component is complexified, such that the corresponding value in the alternating signature $\{+,-,+,-,\ldots{}\}$ 
is explicit.

In \cref{tab:results5parton1L,tab:results5parton} we show numerical results for
the bare one-loop and two-loop four-parton helicity amplitudes.
The results have been obtained with exact values for the 
integral coefficients\footnote{
  The exact rational values are obtained via finite-field evaluations and rational reconstruction (see \cref{sec:ff_fp}).
} 
and with the master integrals 
evaluated to a precision that allows to show 10
significant digits.


\begin{table}[h]
  \centering
  \begin{adjustbox}{width=1\textwidth}
    \begin{tabular}{cccccc}
      \toprule
      $\CA^{(1)[N_f^0]}/\CA^\mathrm{(norm)}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   &   $\epsilon^{1}$  &  $\epsilon^{2}$ \\
      \midrule
      $(1_g^+,2_g^+,3_g^+,4_g^+,5_g^+)$ & $0$ & $0$ & $1$ &
      $3.033832975$ & $4.587604357$ \\
      $(1_g^-,2_g^+,3_g^+,4_g^+,5_g^+)$ & $0$ & $0$ & $1$ &
      $5.624431423$ & $16.89796219$ \\
      $(1_g^-,2_g^-,3_g^+,4_g^+,5_g^+)$ &  $-5.000000000$ &
      $-17.88291386$ & $-24.30905600$ & $0.2206218531$ &
      $59.35260478$ \\
      $(1_g^-,2_g^+,3_g^-,4_g^+,5_g^+)$ &  $-5.000000000$ &
      $-17.88291386$ & $-29.50855173$ & $-34.92963561$ &
      $-64.50302993$ \\
      \midrule
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^+,5_g^+)$ & $0$ & $0$ & $1$ &
      $5.892137144$ & $18.35590938$ \\
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^+,5_g^-)$ & $-4.000000000$ &
      $-13.76243861$ & $-15.50477253$ & $17.23285932$ &
      $101.5375461$ \\
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^-,5_g^+)$ & $-4.000000000$ &
      $-13.76243861$ & $-17.97203103$ & $1.496892271$ &
      $50.75427433$ \\
      $(1_q^+,2_{\bar q}^-,3_g^-,4_g^+,5_g^+)$ & $-4.000000000$ &
      $-13.76243861$ & $-16.98218729$ & $7.025105072$ &
      $65.53899984$ \\
      \midrule
      $(1_q^+,2_{\bar q}^-,3_Q^-,4_{\bar Q}^+,5_g^+)$ &
      $-3.000000000$& $-8.843501370$ & $-1.852152501$ &
      $37.28945738$
      & $105.9935237$ \\
      $(1_q^+,2_{\bar q}^-,3_Q^+,4_{\bar Q}^-,5_g^+)$ &
      $-3.000000000$& $-8.843501370$ & $-4.411871382$ &
      $26.32328221$ & $81.15715418$ \\
      $(1_q^+,2_{\bar q}^-,3_Q^-,4_{\bar Q}^+,5_g^-)$ &
      $-3.000000000$& $-8.843501370$ & $342.9945174$ &
      $1000.539160$ & $-355.3299610$ \\
      $(1_q^+,2_{\bar q}^-,3_Q^+,4_{\bar Q}^-,5_g^-)$ &
      $-3.000000000$&
      $-8.843501370$ & $-1.744812968$ & $-9.470771643$ &
      $-176.4533405$ \\
      \toprule
      $\CA^{(1)[N_f^1]}/\CA^\mathrm{(norm)}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   &   $\epsilon^{1}$  &  $\epsilon^{2}$ \\
      \midrule
      $(1_g^+,2_g^+,3_g^+,4_g^+,5_g^+)$ & $0$ & $0$ &
      $-1.000000000$ & $-4.033832975$ & $-8.621437332$ \\
      $(1_g^-,2_g^+,3_g^+,4_g^+,5_g^+)$ & $0$ & $0$ &
      $-1.000000000$ & $-6.624431423$ & $-23.52239361$ \\
      $(1_g^-,2_g^-,3_g^+,4_g^+,5_g^+)$ &  $0$ & $0.6666666667$ &
      $2.494683591$ & $2.329188091$ & $-8.735477566$ \\
      $(1_g^-,2_g^+,3_g^-,4_g^+,5_g^+)$ &  $0$ & $0.6666666667$ &
      $3.475701080$ &  $8.982161551$ &  $14.85398827$ \\
      \midrule
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^+,5_g^+)$ & $0$ & $0$ &
      $-0.3542206031$ & $-2.268220888$ & $-7.918667025$ \\
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^+,5_g^-)$ & $0$ & $0$ &
      $-0.5535785746$ & $-3.637432164$ & $-12.69744845$ \\
      $(1_q^+,2_{\bar q}^-,3_g^+,4_g^-,5_g^+)$ & $0$ & $0$ &
      $-0.0008015520164$ & $-0.004344237791$ & $-0.01257682159$
      \\
      $(1_q^+,2_{\bar q}^-,3_g^-,4_g^+,5_g^+)$ & $0$ & $0$ &
      $-0.04501904941$ & $-0.2962279378$ & $-1.036895298$ \\
      \midrule
      $(1_q^+,2_{\bar q}^-,3_Q^-,4_{\bar Q}^+,5_g^+)$ & $0$ &
      $-0.6666666667$ & $-2.939327989$ & $-7.089932089$ &
      $-11.96893214$ 
      \\
      $(1_q^+,2_{\bar q}^-,3_Q^+,4_{\bar Q}^-,5_g^+)$ & $0$ &
      $-0.6666666667$ & $-2.933154494$ & $-7.055606900$ &
      $-11.86563786$ 
      \\
      $(1_q^+,2_{\bar q}^-,3_Q^-,4_{\bar Q}^+,5_g^-)$ & $0$ &
      $-0.6666666667$ & $-57.49865762$ & $-259.2491530$ &
      $-668.4609808$
      \\
      $(1_q^+,2_{\bar q}^-,3_Q^+,4_{\bar Q}^-,5_g^-)$ & $0$ &
      $-0.6666666667$ & $1.491351996$ & $9.944256190$ & 
      $24.03526126$ \\
      \bottomrule
    \end{tabular}
  \end{adjustbox}
  \caption{The bare one-loop five-parton helicity amplitudes 
  evaluated at the phase space point in \cref{eq:EvalPoint5}. We set the
    normalization factor $\CA^\mathrm{(norm)}$ to $\CA^{(1)[N_f^0]}(\epsilon=0)$ for the
    amplitudes with vanishing trees, and to $\CA^{(0)}$ otherwise.}
  \label{tab:results5parton1L}
\end{table}

\begin{table}[!htbp]
  \centering
  \begin{adjustbox}{width=1\textwidth}
    \begin{tabular}{cccccc}
      \toprule
      $\CA^{(2)[N_f^0]}/\CA^\mathrm{(norm)}$	  &   $\epsilon^{-4}$   &   $\epsilon^{-3}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   \\
      \midrule
      $( 1_g^+, 2_g^+, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & $-5.000000000$ & $-29.38541207$ & $-62.68413553$ \\
      $( 1_g^-, 2_g^+, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & $-5.000000000$ & $-42.33840431$ & $-159.9778589$ \\
      $( 1_g^-, 2_g^-, 3_g^+, 4_g^+, 5_g^+ )$ & $12.50000000$ & $84.83123596$ & $243.4660216$ & $301.9565843$ & $-152.0528809$ \\
      $( 1_g^-, 2_g^+, 3_g^-, 4_g^+, 5_g^+ )$ & $12.50000000$ & $84.83123596$ & $269.4635002$ & $551.6251881$ & $984.0882231$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & $-4.000000000$ & $-33.66432052$ & $-117.5792214$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+, 5_g^- )$ & $8.000000000$ & $51.38308777$ & $127.3357346$ & $55.24748112$ & $-511.9128286$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^-, 5_g^+ )$ & $8.000000000$ & $51.38308777$ & $137.2047686$ & $143.1002284$ & $-154.2224796$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^-, 4_g^+, 5_g^+ )$ & $8.000000000$ & $51.38308777$ & $133.2453937$ & $110.9941406$ & $-263.9507190$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^-, 5_g^+ )$ & $4.500000000$ & $23.78050411$ & $33.01035431$ & $-76.65528489$ & $-305.7123751$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+, 5_g^+ )$ & $4.500000000$ & $23.78050411$ & $25.33119767$ & $-122.8050519$ & $-400.0885233$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^-, 5_g^- )$ & $4.500000000$ & $23.78050411$ & $25.00917906$ & $16.91995611$ & $579.1225796$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+, 5_g^- )$ & $4.500000000$ & $23.78050411$ & $-1009.208812$ & $-4797.768367$ & $4827.790534$ \\
      \midrule
      $\CA^{(2)[N_f^1]}/\CA^\mathrm{(norm)}$	  &   $\epsilon^{-4}$   &   $\epsilon^{-3}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   \\
      \midrule
      $( 1_g^+, 2_g^+, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & $5.000000000$ & $34.38541207$ & $78.06348509$ \\
      $( 1_g^-, 2_g^+, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & $5.000000000$ & $47.33840431$ & $206.9626532$ \\
      $( 1_g^-, 2_g^-, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & $-2.500000000$ & $-15.82327813$ & $-36.65791641$ & $-15.54781774$ \\
      $( 1_g^-, 2_g^+, 3_g^-, 4_g^+, 5_g^+ )$ & 0 & $-2.500000000$ & $-20.72836557$ & $-83.86917083$ & $-215.3966037$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & $1.416882412$ & $11.98234731$ & $38.78056708$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+, 5_g^- )$ & 0 & $0.6666666667$ & $7.912904946$ & $38.94492002$ & $78.45710970$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^-, 5_g^+ )$ & 0 & $0.6666666667$ & $5.701796856$ & $20.47669656$ & $20.24036826$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^-, 4_g^+, 5_g^+ )$ & 0 & $0.6666666667$ & $5.878666845$ & $21.43074531$ & $17.31964894$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^-, 5_g^+ )$ & 0 & $2.500000000$ & $17.25407596$ & $48.27686582$ & $11.71960460$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+, 5_g^+ )$ & 0 & $2.500000000$ & $17.27259645$ & $44.99884204$ & $-15.14666233$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^-, 5_g^- )$ & 0 & $2.500000000$ & $3.980556493$ & $-29.18374008$ & $-149.0347042$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+, 5_g^- )$ & 0 & $2.500000000$ & $180.9505853$ & $624.1255757$ & $-2759.824817$ \\
      \midrule
      $\CA^{(2)[N_f^2]}/\CA^\mathrm{(norm)}$	  &   $\epsilon^{-4}$   &   $\epsilon^{-3}$   &   $\epsilon^{-2}$   &   $\epsilon^{-1}$   &   $\epsilon^{0}$   \\
      \midrule
      $( 1_g^+, 2_g^+, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & 0 & 0 & $13.52483164$ \\
      $( 1_g^-, 2_g^+, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & 0 & 0 & $0.08295433103$ \\
      $( 1_g^-, 2_g^-, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & 0 & 0 & $0.2400910586$ \\
      $( 1_g^-, 2_g^+, 3_g^-, 4_g^+, 5_g^+ )$ & 0 & 0 & 0 & 0 & $0.008096515560$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+, 5_g^+ )$ & 0 & 0 & 0 & $0.2361470687$ & $2.541010053$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^+, 5_g^- )$ & 0 & 0 & 0 & $0.3690523831$ & $3.782474720$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^+, 4_g^-, 5_g^+ )$ & 0 & 0 & 0 & $0.0005343680110$ & $0.004830824685$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_g^-, 4_g^+, 5_g^+ )$ & 0 & 0 & 0 & $0.03001269961$ & $0.3139119453$ \\
      \midrule
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^-, 5_g^+ )$ & 0 & 0 & $0.4444444444$ & $3.910872659$ & $18.01752271$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+, 5_g^+ )$ & 0 & 0 & $0.4444444444$ & $3.919103985$ & $18.09637714$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^+, 4_{\bar Q}^-, 5_g^- )$ & 0 & 0 & $0.4444444444$ & $-1.988469328$ & $-28.36258323$ \\
      $( 1_q^+, 2_{\bar q}^-, 3_Q^-, 4_{\bar Q}^+, 5_g^- )$ & 0 & 0 & $0.4444444444$ & $76.66487683$ & $646.7253090$ \\
      \bottomrule
    \end{tabular}
  \end{adjustbox}
  \caption{The bare two-loop five-parton helicity amplitudes evaluated
    at the phase space point in \cref{eq:EvalPoint5}. We set the
    normalization factor $\CA^\mathrm{(norm)}$ to $\CA^{(1)[N_f^0]}(\epsilon=0)$ for the
    amplitudes with vanishing trees, and to $\CA^{(0)}$ otherwise.} 
  \label{tab:results5parton}
\end{table}

\section{Validation}
\label{sec:Validation-5parton}

We have carried out an extensive set of checks on our computational setup and results for the amplitudes.

\subsubsection{Computational setup}
\begin{itemize}
  \item We checked that all surface terms integrate to zero by IBP-reducing them with \texttt{FIRE}
\cite{Smirnov:2008iw,Smirnov:2014hma,Smirnov:2019qkx} on a fixed numerical kinematic
point.
\item
After the cut equations \cref{eq:cut_equations} are solved for the coefficients, we evaluate
the left-hand side on a new point, and compare it to the results obtained using the known values of coefficients on the right-hand side.
This is known as ``$N=N$ test''.
\item The whole computation of coefficients is performed either with floating point, or with finite fields (recombined into rational numbers).
  The results agree.
\item Two different sets of master integrals are employed to obtain the values for the amplitudes. The results agree.
\end{itemize}
The first two checks combined together are very powerful, since they validate that the expected
integrand parametrization for each topology is indeed the complete and non-redundant description of the whole amplitude.
This is non-trivial, since we never deal with the integrand of the amplitude at once, and evaluate 
each cut diagram through a product of tree amplitudes.

For all four-parton and five-parton amplitudes we verified,
that they satisfy the
expected infrared pole structure (see \cref{sec:IR}).

\subsubsection{Results from other sources}

The one-loop amplitudes, shown in \cref{tab:results4parton1L,tab:results5parton1L} which we obtained from our own setup,
are cross-checked up to order $\epsilon^0$ with \BlackHat{}~\cite{Berger:2008sj}

We have carried out a systematic
validation of the $\epsilon^0$ contributions of all four-parton amplitudes against their known analytic
expressions from refs.~\cite{Bern:2002tk,Bern:2003ck,DeFreitas:2004kmi,Glover:2004si}. 
For the four-gluon amplitudes we have compared directly the
$\epsilon^0$ pieces of our results with the analytic expressions of~\cite{Bern:2002tk}.
For the two-quark two-gluon and four-quark amplitudes we have used the one-loop results given in \cref{tab:results4parton1L}
to compute the corresponding finite remainders $\CF^{(2)}$ as
defined in \cref{eq:remainderDef}. 
After accounting for the different choices of 
normalization for the $\mathbf{H}_{[n]}(\epsilon)$ operators 
(see \cref{sec:IR})
made in refs.~\cite{Bern:2003ck} and \cite{Glover:2004si},
we have found perfect agreement.

The $N_f^0$ piece of the all-plus five-gluon amplitude have been
checked to reproduce the analytic result
of \cite{Gehrmann:2015bfy}, and for the other helicity 
configurations we have validated the results of
\cite{Badger:2017jhb} with our implementation.
We also find agreement with the numerical results of the $N_f^0$ terms
of the two-quark three-gluon and four-quark one-gluon two-loop
amplitudes which have been presented in the revised version of
ref.~\cite{Badger:2018gip}.


\section{Reconstruction of Analytic Form}
\label{sec:AnalyticForm}
In this section we explain how we obtain analytic expressions for the amplitudes from samples of their numerical evaluations over finite fields.

The coefficients of master integrals $c_{\Gamma,i}$ in \cref{eq:ampl_master_integrals} are rational
functions of external kinematics $\vb*{x}$ (and $D$), 
and we have set up an algorithm for their exact numerical evaluation.
Therefore, given a large enough ansatz for the coefficients\footnote{
  here the vector-exponent notation for monomials is as in \cref{chap:stdtech,chap:numunitarity}
}
\begin{equation}
  c_{\Gamma,i}(\mathbf{x}) = \frac{\sum_{\va{j}} n_{\Gamma,i;\,\va{j}}~\mathbf{x}^{\va{j}}}{\sum_{\va{j}}d_{\Gamma,i;\,\va{j}} ~ \mathbf{x}^{\va{j}}},
\end{equation}
in principle, we can evaluate $c_{\Gamma,i}(\vb*{x})$ enough times to generate and solve the systems of linear equations
for rational numbers $n_{\Gamma,i;\,\va{j}}$ and  $d_{\Gamma,i;\,\va{j}}$. Here we ignore the $D$-dependence, since
we already know it analytically (see \cref{sec:dimensional_reconstruction} for details).
However, due to $\order{N^3} $ scaling of the algorithms for solving $N\times N$ linear systems, this is not practical.
This topic has received a lot of attention recently and more advanced 
algorithms for reconstruction of generic rational functions have been developed \cite{Peraro:2019svx,Peraro:2016wsq,Klappert:2019emp},
which allow to minimize the computational cost of the reconstruction algorithm itself.
In any case, the reduction of amplitudes to obtain the coefficients $c_{\Gamma,i}(\vb*{x})$ is computationally expensive,
and the minimal number of evaluations scales as $\left(\substack{n+R \\ n }\right)$ with the number of variables $n$ and the
polynomial degree $R$.
For the reconstruction of the master-integral coefficients of five-parton amplitudes the complexity is prohibitive.


Fortunately, the full physical information about the scattering is contained in finite remainders, defined in \cref{eq:remainderDef}.
Hence, instead of reconstructing the coefficients of master integrals, we can write the finite remainders in terms of pentagon functions,
\begin{equation}
  \mathcal{F}^{(2)} = \sum_{i \in B} r_i(\vb*{x}) h_i\,.
  \label{eq:remainderPentagon}
\end{equation}
and reconstruct the coefficients $r_i(\vb*{x})$. 
To obtain this decomposition we use the same basis $B$ of pentagon functions as in \cref{eq:pentagon_function_decomposition} 
for $\mathbf{I}_{[n]}^{(1)}\mathcal{A}_R^{(1)}$ and $\mathbf{I}_{[n]}^{(2)}\mathcal{A}_R^{(0)}$ from \cref{eq:remainderDef}.
We checked, that indeed the coefficients $r_i(\vb*{x})$ have lower total degree, compared to the coefficients of master integrals, as expected.

In the following, we will further exploit the physical constraints on the amplitudes to simplify
the reconstruction. We will see, that we will not, in fact, need to reconstruct multivariate \emph{rational} functions at all,
and it is sufficient to perform a univariate rational-function reconstruction, and a reconstruction of a
multivariate \emph{polynomial}.

\subsection{Choice of Variables}

The complexity of reconstruction, clearly, depends on the choice of variables, in which 
the reconstruction is performed. In this section we discuss our choice for the reconstruction of remainders.

So far we have been mostly indifferent as to how we parametrize the external kinematics $\vb*{x}$.
The only condition, in order to be able to carry out exact evaluation, was that the components of external momenta
are rational numbers, which is directly implemented by the \emph{momentum-twistor} variables \cite{Hodges:2009hk}.
It then seems natural to try to reconstruct the coefficients $r_i$ in these variables.
It turns out, however, that this is not the optimal choice.
In the following we argue, that the reconstruction of $r_i$ in terms of Mandelstam variables $s_{ij}=(p_{i}+p_j)^2$, 
\begin{equation}\label{eq:mandelstams}
\vec s \coloneqq \{s_{12},s_{23},s_{34},s_{45},s_{51}\}\,,
\end{equation}
and the parity-odd contraction of four 
momenta 
\begin{equation}\label{eq:tr5Def}
\trFive \coloneqq  4 i \varepsilon^{\mu\nu\rho\sigma}
p_{1\mu} p_{2\nu} p_{3\rho} p_{4\sigma}\, ,
\end{equation}
with the Levi-Civita symbol $\varepsilon_{\mu\nu\rho\sigma}$, achieves lower total degree.
The reason why we have to introduce the variable $\trFive$, is that 
it is not rationally-parametrizable in terms of the Mandelstam variables.
It's square, however, is, since it is equal to the five-point Gram determinant.
The Mandelstam variables 
make manifest the dependence on
the external momenta, and therefore also any possible symmetries related to 
exchanges of external legs.

To be able to reconstruct in these variables, first we need to find a rational 
parametrization of the external kinematics.
We keep four of the Mandelstam invariants
$\{ s_{12}, s_{23}, s_{45}, s_{51} \}$ and introduce an auxiliary variable $x$.
More explicitly, we consider the Mandelstam invariants as functions of
this new set of variables,
\begin{equation}
  \vec s\equiv \vec s\,(s_{12}, s_{23}, s_{45}, s_{51},x)\,,
\end{equation}
and, rescaling the momenta such that $s_{12}=1$, $s_{34}$ is defined in terms of
$x$ as
\begin{align}
\begin{split}
  s_{34}\equiv
    s_{34}(s_{23}, s_{45} , s_{51}, x) =& \frac{ (s_{45} - 1) s_{51} x -
	s_{23} (s_{23} -  s_{45} - s_{51} - x)}{(s_{45} - s_{23} + x)\,x}\,.
    \label{eq:s34Definition}
\end{split}
\end{align}
This parametrization follows from the one given in \cref{sec:twistors}.
For any (generic) fixed value of the invariants $\vec s$
there are two corresponding values of $\{x,\bar x\}$, corresponding to the 
two solutions to the quadratic equation in \eqref{eq:s34Definition}.
These two different points in phase space are parity conjugates, 
and correspond to opposite signs of $\trFive$ . 
Under this transformation,
\begin{align} 
  \label{eq:parity}
  \trFive\to-\trFive\,,\qquad
  x\to\bar x=
  \frac{s_{23}(s_{23}-s_{45}-s_{51})}{s_{34}(s_{12}, s_{23}, s_{45}, s_{51},x)\,x}\,.
\end{align}

Next, we discuss our ansatz for the rational coefficients $r_i$ and the sampling procedure.
To this end, we decompose each function $r_i$ into parity odd and even parts\footnote{
  As $\trFive{}^2$ is manifestly polynomial in the invariants, it is clear that
  no higher powers in $\trFive$ are required. 
},
\begin{equation}
    \label{eq:ripmdef}
		 r_i(\vec s, \trFive ) = r_i^+(\vec s\,)  + \trFive \, r_i^-(\vec s\,)\,. 
\end{equation}
%

While the functions $r_i^{\pm}$  are rational in the Mandelstam 
invariants $\vec s$, their
definition through eq.~\eqref{eq:ripmdef} only allows them to be
evaluated via the functions $r_i$ which, due to the presence of
$\trFive$, are not rational in the invariants themselves. 
For this reason, we first isolate the even and odd parts $r_i^\pm$
and reconstruct them in terms of the Mandelstam variables $\vec s$.
As the parity conjugate points $\{s_{23},s_{45},s_{51}, x\}$
and $\{s_{23},s_{45},s_{51}, \bar x\}$ 
correspond to  the same  value of the invariants $\vec s$, we can use
this pair of points to evaluate the $r_i^{\pm}$ on a single point~$\vec s$,
\begin{eqnarray}
		r^+_i(\vec s\, ) &=& \frac{1}{2} \big[ r_i(\vec s, x ) + r_i(\vec s,\bar x ) \big]\,,\\
		r^-_i(\vec s\, ) &=& \frac{1}{2\, \trFive } \big[ r_i(\vec s,x ) - r_i(\vec s,\bar x ) \big]\,.
\end{eqnarray}



To illustrate the advantage of the approach outlined above compared with the
strategy used in \cite{Abreu:2018zmy}, we show in
figure~\ref{fig:degrees-twXsij}  the polynomial-degree drop for the
two most complex remainders, separating the different $\NF$ contributions.
This observation is common to all five-parton remainders at $N_f^0$ and $N_f^1$: 
we observe a drop of the polynomial degree in the numerators  $n_i^\pm(\vec s)$ by 
40\%-50\% when written in terms of Mandelstam variables as compared to the twistor 
variables.

\begin{figure}[ht]
  \centering
  \includegraphics[width = 0.7\textwidth]{plots/twistorXsijs_comparison.pdf}
  \caption{
    Maximal degrees of numerators of the two most complicated amplitudes in momentum-twistor and $s_{ij}$ variables.
    Our choice of the twistor parametrization is given in \cref{sec:twistors}.
  }
  \label{fig:degrees-twXsij}
\end{figure}


\subsection{Universal Denominators}

The coefficient functions $\{r_i\}_{i\in B}$ introduced in
\cref{eq:remainderPentagon}  have a universal pole 
structure~\cite{Abreu:2018zmy,Abreu:2019odu} which we find to be expressible in terms of
the so-called planar alphabet $A$ of the pentagon functions \cite{Gehrmann:2018yef}.
The planar alphabet $A$ is given in terms
of 26 letters $\{W_i\}_{i\in A}$ which are rational functions of $\{\vec{s},\trFive\}$.
The letters can be further grouped into parity even and odd letters, 
$A^+$ and $A^-$ respectively, with $A=A^+\cup A^-$.\footnote{Parity here refers to  
  the transformation properties of the letters under a parity transformation in 
momentum space.}
The functions $r_i$ are rational functions in the variables ${\vec s}$ and $\trFive$,  
whose denominators are monomials in the letters,
\begin{equation}
    r_i = \frac{n_{i}}{ W^{\vec q_i}}\,.
    \label{eq:letterDecomposition}
\end{equation}
The vector of exponents $\vec q_i=\{q_{i,1}, ... q_{i,26}\}$ 
differs between the coefficient functions, and for a given
coefficient function $r_i$ not all letters contribute. The pattern of
contributing letters is linked to the pentagon functions and helicity
dependent~\cite{Abreu:2018zmy,Abreu:2019odu}. 
We will refer to the set of 
independent factors in a monomial such as $W^{\vec\alpha}$ as $A_\alpha$,
\begin{equation}\label{eq:A_alp}
		A_\alpha = \{ i\,|\, i \in A \quad \mbox{with} \quad \alpha_i\neq 0 \} \,.
\end{equation}

A further simplification to the reconstruction procedure 
is achieved from realizing that the
denominators of $r_i^{\pm}$ can be written as in eq.~\eqref{eq:letterDecomposition},
with the extra requirement that no odd letters appear,
\begin{equation}
    r^\pm_i(\vec s\,)  = \frac{n_i^\pm(\vec s\,) }{W^{\vec q_i}(\vec s\,) }\,,
   \label{eq:DenominatorAnsatz}
\end{equation}
where the $n_i^\pm(\vec s\,)$ are polynomials in the invariants and
the contributing $W_j(\vec s\,)$ are polynomials in the $\vec s$ only (and not $\trFive$). 
To test this
ansatz and determine the exponent vector $\vec q_i$, we consider the functions
$r_i^{\pm}$ on a `univariate slice' where the variables depend on a single parameter 
$t$, $\{s_{23}(t),s_{45}(t),s_{51}(t), x(t)\}$. 
We then reconstruct the univariate functions $r_i^{\pm}(t)$ using Thiele's formula (see \cref{sec:thiele}) and match the denominators 
with a monomial in the letters $W_i(\vec s\,[t])$ in order to obtain the exponent vector $\vec q_i$.
For this to work, we must choose a curve on which all 
letters $W_i(\vec s\,[t])$ are distinct functions of $t$.
Furthermore, if we require that all invariants are linear in $t$, this 
procedure will also tell us the total degree of the numerator polynomials  
$n_i^\pm(\vec s\,)$ in the Mandelstam variables. Such a curve is given by, e.g., 
\begin{equation}
  \begin{aligned}
    x(t) &= c_0, \\
    s_{45}(t) &= c_2 + d_2 t,
  \end{aligned}
  \qquad
  \begin{aligned}
    s_{23}(t) &= c_1 + d_1 t,  \\ 
    s_{51}(t) &= c_3 \big(x(t) - s_{23}(t) + s_{45}(t) \big)\,,
  \end{aligned}
\end{equation}
where the variables $c_i$ and $d_i$ take fixed, arbitrary values.
With this procedure, we confirmed the ansatz of eq.~\eqref{eq:DenominatorAnsatz}
and thus determined all the denominators of the rational functions $r_i^{\pm}$.

The problem of reconstructing the $r_i^{\pm}$ is now reduced to the
reconstruction of the polynomials $n^\pm_i$. We perform the reconstruction
of $n_i^\pm(\vec s)$ directly in terms of the Mandelstam variables
employing the modified form of the recursive Newton method (see \cref{sec:newton_rec}).
Note, that we already determined the maximal total degree of these polynomials from the univariate slice.

In this way, we have managed to reconstruct the remainders of all five-parton amplitudes.
As an indication for the final complexity of the reconstruction we show the
numerator degrees for the $N_f^0$ contribution of all the planar five-parton
remainders in figure~\ref{fig:degrees-all}.
The most demanding remainder was of the $\mathcal{A}^{(2)[N_f^1]}(g^-,g^+,g^-,g^+,g^+)$ partial amplitude.
In total, 94,696 phase-space points  (coming in parity conjugate pairs) were necessary for its reconstruction.

\begin{figure}[ht]
  \centering
  \includegraphics[width = 0.7\textwidth]{plots/plot_sijs.pdf}
  \caption{Maximal degrees of numerators of $N_f^0$ components of the amplitudes in $s_{ij}$ variables.}
  \label{fig:degrees-all}
\end{figure}



\subsection{Processing of Reconstructed Expressions}
%
So far everything was done in a finite field.

With the aim to simplify the rational reconstruction of finite-fields coefficients, we
introduce an algorithm to uniquely obtain a multivariate partial-fraction decomposition of the analytic expressions.

\subsubsection{Basis of Rational Coefficients}

It was noted in \cite{Abreu:2018aqd,Chicherin:2018yne,Abreu:2019rpt,Chicherin:2019xeg} 
that the space of independent rational
functions appearing in the $\mathcal{N}=4$ super Yang-Mills (SYM) and $\mathcal{N}=8$ super gravity
two-loop five-point amplitudes is much smaller than the space of possible independent
pentagon functions. This motivates us to apply the same analysis here, both
in order to allow performing minimal reconstruction work and as a way to obtain
simpler analytic expressions.
These linear dependencies between the rational functions allow us to express the 
remainder of each amplitude as
\begin{equation}
		\mathcal{F}^{(2)} = 
		\sum_{i\in K ,\, j\in \hat B} r_i M_{ij} h_j,
\label{eq:remainderDecomposition}
\end{equation}
where $r_i$ is a vector of rational coefficients and $K$ denotes
the dimension of the space they span.
The index $j$ runs over a subspace $\hat B$ of the space $B$ of all pentagon functions 
introduced in \cref{eq:remainderPentagon}, i.e.\  $\hat B\subseteq B$. 
The constant matrix $M$, the rational functions $r_i$ 
and the index sets $K$ and $\hat B$ are helicity-amplitude dependent.


The basis of rational functions $r_i$ is not unique
and we choose it by taking the linearly independent subset with
the lowest total polynomial degree. The associated matrix $M$
can be computed numerically in the finite field used for the analytic reconstruction,
using as many evaluations as its rank. 
In order to rationally reconstruct $M$ we only
require one finite field of cardinality $\mathcal{O}(2^{31})$, apart from two
cases where we combine information from two finite fields (see more details in 
section~\ref{sec:results}).

%\begin{figure}[ht]
  %\centering
  %\includegraphics[width = 1.0\textwidth]{plots/function_space_dimensions.pdf}
  %\caption{
    %The number of linearly-independent coefficient functions $r_i^\pm$ for the five-parton amplitudes.
    %The three stacked bars display the case when the three different $N_f$ contributions are considered separately,
    %while the bar labeled $N_f^0\cup N_f^1\cup N_f^2$ displays the number of independent functions
    %when all $N_f$ contributions are combined.
  %}
  %\label{fig:remainderStructure}
%\end{figure}


\subsubsection{Partial Fractions}
\label{sec:PartialFractions}

Having chosen a basis of rational coefficients, we study the $\{r_i^\pm\}_{i\in K}$
in a finite field, obtained with the strategy described 
in \cref{sec:reconstructionInvs}.
The next step is to lift the finite-field result to the rational numbers, 
i.e.\  to rationally reconstruct the result. 
The correctness of the rational reconstruction can
be verified by comparison against a single evaluation on a
different finite field. 
In general, the success of the rational reconstruction is
guaranteed if the numerator and denominator of the original rational
number satisfy a bound dependent on the finite-field cardinality
\cite{Wang:1981:PAU:800206.806398, vonManteuffel:2014ixa, Peraro:2016wsq},
i.e.\  rational numbers with numerators and denominators with
smaller absolute values are more easily reconstructed from their finite-field
images. As such, it is beneficial if we can find a form of the
$r_i^\pm$ where the rational numbers involved have `simple' numerators and
denominators. 
To this end, we will employ a multivariate partial-fraction decomposition
of the $r_i^\pm$, which will also have the side effect of simplifying their
analytic form as a whole. 
Indeed, the partial-fraction decomposition manifests the singularities
of the coefficients, which are controlled by physical properties such
as the factorization of the amplitude in specific limits.


We will employ the partial-fraction decomposition introduced by
Lenartas \cite{leinartas1978factorization,raichev2012leinartas}.
This decomposition has recently been used for bringing differential equations into
canonical form~\cite{Meyer:2016slj}, as well as for the
analytic reduction of loop integrands~\cite{Zhang:2012ce, Mastrolia:2012an}.
A Lenartas decomposition of our basis functions is given by
\begin{equation}
    r_i^{\pm} = \sum_{\vec\alpha \in D_i} \frac{n^{\pm}_{i,\vec\alpha}}{ 
	W^{\vec\alpha} }\,.
    \label{eq:LeinartasDecomposition}
\end{equation}
That is, the $r_i^{\pm}$ are written as a linear combination of rational
functions which we label by the exponents $\alpha$ of the denominators.
The set of all $\vec\alpha$ for a given $r_i^{\pm}$ is denoted by $D_i$ (we combine
the exponents for the even and odd coefficients). The 
$\{n_{i,\vec\alpha}^\pm \}_{\vec\alpha\in D_i}$ are the numerators associated
with the rational function labelled by $\vec\alpha$,
which are polynomials in the $\{\vec s\}$ variables.
We construct the Lenartas decomposition 
\eqref{eq:LeinartasDecomposition} coefficient-by-coefficient, such that the exponents in 
$\vec\alpha\in D_i$ are non-vanishing only for the letters appearing 
in the starting denominator $W^{\vec q_i}$, see \cref{eq:DenominatorAnsatz}, 
which we recall are polynomials in the $\vec s$.
The particular algorithm which we employ to uniquely specify the 
Lenartas decomposition is related to the techniques 
of \cite{Smirnov:2005ky}.

A Lenartas decomposition given by \cref{eq:LeinartasDecomposition}
is characterized by exponents of the denominator factors. 
All denominators $W^{\vec \alpha}$
in a Lenartas decomposition  are `algebraically independent', in that
there exists no non-zero polynomial  
$P(w)$, such that it vanishes upon inserting the denominator factors, 
\begin{equation}\label{eq:algDep}
P\big(\{ W_i \}_{i\in A_\alpha}\big )=0\,,
\end{equation}
where $A_\alpha$ denotes the set of letters in $W^{\vec \alpha}$, see eq.~\eqref{eq:A_alp}.
Let us make a few comments about such a decomposition.  First, individual terms
in eq.~\eqref{eq:LeinartasDecomposition} may have factors raised to higher
degree than when expressed over a common denominator as in 
eq.~\eqref{eq:DenominatorAnsatz}. Second, no term can have
more denominator factors than the number of variables $\vec s$ as these factors would
necessarily be algebraically dependent.  Also, we note that the Lenartas
decomposition is different to an iterated univariate partial-fraction decomposition in that
it maintains the original denominator structures of the input 
function, i.e.\  in our case, of eq.~\eqref{eq:DenominatorAnsatz}. Finally, in
ref.~\cite{raichev2012leinartas} it is noted that such a
decomposition is in general not unique, due to how the algebraic dependence relations
\eqref{eq:algDep} are resolved.
Let us illustrate this point by considering
\begin{equation} 
P(w_3,w_4,w_6)=w_3 + w_4 - w_6\,,
\end{equation} 
which clearly vanishes upon 
using the definitions of the letters, 
$W_3=s_{34}, W_4=s_{45} $ and 
$W_6 =s_{34} + s_{45}$. 
The dependence relation implies a relation between multiple terms with different denominator factors,
\begin{equation}\label{eq:arbitraryLeinartas}
0= \frac{P(W_3,W_4,W_6)}{W_3 W_4 W_6} 
= \frac{1}{W_4 W_6} + \frac{1}{W_3 W_6} - \frac{1}{W_3 W_4}\,, 
\end{equation}
which can be used to remove either of the three denominator factors on the right-hand side.
This arbitrariness in the implementation of the Lenartas decomposition will
in general lead to expressions that are not as compact as possible if inconsistent choices
are made across different terms being decomposed.
In the following we describe
an approach that produces a unique Lenartas decomposition by providing 
a global prescription to expand algebraic dependencies of the denominators of a given
coefficient $r_i^{\pm}$.

Our approach makes use of multivariate polynomial division and
Grbner basis techniques. In summary, we reinterpret a rational
function in a polynomial way in order to employ division by a Grbner basis
to find a canonical form of a
polynomial which is subject to a series of constraints. The set of
constraints among the variables form a generating set of an ideal and
if one divides a polynomial in these variables by a Grbner basis of
the ideal, the remainder is unique and `minimal' with respect to the
relations. In the rest of this section we describe these steps in more
detail. We refer the reader to ref.~\cite{cox2013ideals} for a pedagogical
discussion of all the required concepts in polynomial-division algorithms.

Our starting point is a rational function $r_i^\pm$ 
of the form \eqref{eq:DenominatorAnsatz}, and 
we introduce an auxiliary variable for each
denominator factor $W_j$ for $j\in A_{q_i}$, where we recall $A_{q_i}$ denotes
the set of labels of letters appearing in the denominator of $r_i^\pm$.
More precisely we introduce variables $Q_j$ to which we
associate the constraint polynomial $C_j(Q_j, \vec s\,)$,
\begin{align}
    C_j &= W_j (\vec s) \, Q_j - 1\,, 
	\quad\mbox{for all}\quad  j \in  A_{q_i}\,.
   \label{eq:PartialFractionConstraints}
\end{align}
Setting all $C_j = 0$ (i.e.\  working in the equivalence class of the ideal 
generated by $\{ C_j \}_{j \in A_{q_i}}$)
imposes the constraint that multiplication by $Q_j$
is equivalent to division by $W_j$. 
As such, subject to this constraint we can
express eq.~\eqref{eq:DenominatorAnsatz} in a polynomial fashion as
\begin{equation}
    r_i^{\pm}(\vec{s}\,) \sim n_i^{\pm}(\vec s)\, Q^{\vec q_{i}}\,,
    \label{eq:CartialFractionsLifted}
\end{equation}
where the notation '$\sim$' emphasises that the relation holds modulo 
the ideal $\{ C_j \}_{j \in A_{q_i}}$.
In order to uniquely implement the constraints $C_j = 0$, we first divide
the right-hand side of eq.~\eqref{eq:CartialFractionsLifted} by a
Grbner basis of the constraint polynomials 
$\{ C_j \}_{j \in A_{q_i}}$.\footnote{It is important to note that Grbner 
basis division works over any
field. Hence, the algorithm can be be applied before or after rational reconstruction.}
After the division, the original polynomial is rewritten as a linear combination 
of the $C_j$ and a unique remainder, which is a polynomial in the $Q_j$ and the $\vec s$.
We then impose
$C_j=0$, leaving this remainder as the result of the 
partial-fraction decomposition. Finally, 
we replace the $Q_j$ by $1/W_j$ and recover an expression of the form 
of eq.~\eqref{eq:LeinartasDecomposition}. We note that
the Grbner basis of the ideal $\{ C_j \}_{j \in A_{q_i}}$ depends on a 
monomial ordering of the variables $\{ Q_j \}_{j \in A_{q_i}}$ and $\{\vec s\}$, 
which in turn affects the final expression. Effectively, by choosing different
orderings one can specify which 
of the denominator factors $\{ W_j \}_{j \in A_{q_{i}}}$ one 
prefers in the final expression. Once this choice has been made,
the result of the procedure is unique.

Let us now comment on why this simple polynomial division technique achieves a
minimal Lenartas decomposition. First, it is important to recall that
the remainder of the division by a Grbner basis is minimal in the sense that
it cannot be written in terms of a member of the ideal and a new remainder
without that remainder having higher polynomial degree. That is, subject to the
choice of monomial ordering, the remainder has the lowest possible polynomial
degree. With this in mind, it is clear why the division by the constraint
polynomials \eqref{eq:PartialFractionConstraints} will maximally cancel
numerator and denominator: since the second term of the constraint polynomial is
$1$, which is the term with the lowest possible degree (in any monomial orderings),
all possible cancellations between numerator and denominator will occur, as that they
will result in the lowest polynomial degree for the remainder.

We define a monomial order for $W^{\vec\alpha}$ through,
\begin{equation}
  \label{eq:orderingNotation}
  W^{\vec\alpha} < W^{\vec\beta}  \quad \Leftrightarrow \quad \vec\alpha < \vec\beta \,
\end{equation}
with lexicographic ordering of the exponent vectors $\vec\alpha < \vec\beta$.


Another important question is how this division results in a set of denominator
structures with no algebraic dependencies, see eq.~\eqref{eq:algDep}, and 
how the relations are guaranteed to be resolved in a consistent way,
see the discussion around eq.~\eqref{eq:arbitraryLeinartas}.
The fact that algebraic dependencies are implemented follows from a key property of
division by a Grbner basis, which is that it will also apply non-trivial
relations implied by the original set of relations. As already argued in
\cite{raichev2012leinartas}, algebraic dependencies induce such non-trivial
relations. Indeed, if the set of denominator factors of a given term 
\begin{equation}
\label{eq:den}
\frac{1}{W^{\vec \alpha}} \sim Q^{\vec\alpha} 
\end{equation}
are algebraically dependent, then by
definition there exists a non-zero polynomial $P(w)$ such that
$P\big(\{ W_i\}_{i\in A_\alpha}(\vec s)\big) = 0$, which
is trivially a member of the ideal of constraints. 
We associate the same monomial ordering to the $w$ variables as we do to
the $Q_j$ and write the polynomial $P(w)$ in the form
\begin{equation}
    P(w) = c_{\vec\beta}\, w^{\vec\beta} + 
	\sum_{\vec\gamma > \vec\beta} c_{\vec\gamma}\, w^{\vec\gamma}.
\end{equation}
That is, we distinguish the term of lowest monomial degree $\vec\beta$ 
(we refer to the notation introduced in \cref{eq:orderingNotation}). 
Let us now multiply the $Q^{\vec\alpha}$ in eq.~\eqref{eq:den} by this polynomial and 
$Q^{\vec\beta}$. We get
\begin{align}\begin{split}
    0=P\big(\{ W_i(\vec{s}\,)\}_{i\in A_\alpha}\big) Q^{\vec \alpha} Q^{\vec \beta}&= c_{\vec\beta}\,Q^{\vec\alpha} \,Q^{\vec\beta} \,W^{\vec\beta}    + 
  \sum_{\vec\gamma > \vec\beta} c_{\vec\gamma} \,
  Q^{\vec\alpha} Q^{\vec\beta}
  W^{\vec\gamma}(\vec s) \\
    &\sim  c_{\vec\beta}\,Q^{\vec\alpha}     + 
  \sum_{\vec\gamma > \vec\beta} c_{\vec\gamma} \,
    Q^{\theta(\vec\alpha + \vec\beta - \vec\gamma)} 
    W^{\theta(\vec\gamma - \vec\alpha - \vec\beta)}(\vec s)\,,
\end{split}\end{align}
where we introduced the function
$\theta(\vec\alpha)$ which yields a vector with the
negative entries removed. This shows that relations such 
as that of eq.~\eqref{eq:arbitraryLeinartas} are now also in the ideal, 
and we do not have to construct them explicitly. Furthermore,
given that by construction $\vec\gamma > \vec\beta$, we
have  
\begin{equation}
\theta(\vec\alpha + \vec\beta - \vec\gamma) < \vec\alpha\,.
\end{equation}
That is, for each term in the sum over $\gamma$, the $Q$-dependent part of the
monomial is always of lower degree than the original denominator 
structure $Q^{\vec{\alpha}}$.
For any monomial ordering where the $Q_j$ are sorted before the $\vec s$, the term  
$c_{\vec{\beta}}\,Q^{\vec{\alpha}}$ is thus leading and will 
therefore be reduced by the polynomial 
division algorithm, which produces remainders of lower degree.
In summary, the algebraic dependence relations are accounted for in the 
constraint ideal, and will be removed by Grbner basis division. 
If, for instance,
one chooses 
a lexicographic order (with the $Q_j$'s sorted before the $\vec s$ variables), 
this will decrease the power of the $Q_j$ for the lowest $j$, 
at the price of potentially increasing the power of $Q_j$ for higher $j$.
This argument can be applied recursively until all algebraic dependencies have been 
resolved. Because the resolution of the dependencies is based on the polynomial ordering
and implemented by the Grbner basis division, it will be
consistently implemented across all denominator factors of a given $r_i^{\pm}$ and
give a unique Lenartas decomposition.


We close by noting that this procedure is both simple to implement as
well as very efficient, easily handling the complex rational functions
present in the problem.  Furthermore, an important consequence of this
decomposition is that the rational numbers in the expression are
more likely to be small. As discussed at the beginning of this section,
this makes the result in a single finite field of cardinality $\mathcal{O}(2^{31})$ 
sufficient to determine them.



\subsection{Results}

\todo{validation is just evaluation numerically} 

We present our results in the form of ancillary files which can be downloaded
from the source files of this work on the \texttt{arXiv} server. We include the
following files, in \texttt{Mathematica}-readable format:
\begin{itemize}
    \item Analytic expressions for the basis set of one-loop five-parton amplitudes
      expressed in terms of one-loop master integrals, valid to all orders in $\epsilon$;
    \item Expressions for all one-loop master integrals written in terms of pentagon functions through order $\epsilon^2$;
    \item The basis set of two-loop five-parton finite remainders, which are the main result
of this work. For each remainder and at each power of $N_f$, we give a list of independent 
coefficient functions $r_i$, a matrix $M_{ij}$ and a list of pentagon functions $h_j$, consistent with the decomposition of eq.~\eqref{eq:remainderDecomposition};
    \item Scripts that assemble two-loop amplitudes from the remainders. 
      In particular, the \texttt{Mathematica} script \texttt{TwoLoopAmplitudesNumerical.m} uses the 
    analytic expressions to reproduce the numeric values of 
    refs.~\cite{Abreu:2018jgq,Badger:2018gip}, as detailed in the included
    \texttt{README.md} file.
\end{itemize}

Our expressions can be easily adapted to perform numerical integration over
phase space. Indeed, they are very compact (with a compressed size of 1.6 Mb),
and ready for automated algorithms for optimized
evaluation like those included in
FORM~\cite{Kuipers:2012rf,Ruijl:2014spa}.

